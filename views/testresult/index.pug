doctype html
mixin parseSign(value)
    if value > 0
        | +
    = value
html
    head
        meta(charset="utf-8")
        meta(name="viewport" content="initial-scale=1.0")
        title Rorschach
        link(href="/css/bootstrap.min.css" rel="stylesheet" media="all")
        link(href="/font-awesome/css/font-awesome.css" rel="stylesheet" media="all")
        link(href="/css/animate.css" rel="stylesheet" media="all")
        link(href="/css/style.css" rel="stylesheet" media="all")
        link(href="/css/plugins/jasny/jasny-bootstrap.min.css" rel="stylesheet" media="all")
        link(href="/css/plugins/datapicker/datepicker3.css" rel="stylesheet" media="all")
        link(href="/css/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" media="all")
        link(href='/css/table-hover-cells.css', rel='stylesheet')
        link(href='/css/print.css', rel='stylesheet', media='print')
        style.

            .td-small {
                padding-top: 2px !important;
                padding-bottom: 2px !important;
            }
            body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
                background-color: #FAFAFA;
                font: 12pt "Tahoma";
            }
            * {
                box-sizing: border-box;
                -moz-box-sizing: border-box;
            }
            .page {
                width: 210mm;
                min-height: 297mm;
                padding: 20mm;
                margin: 10mm auto;
                border: 1px #D3D3D3 solid;
                border-radius: 5px;
                background: white;
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            }
            .subpage {
                padding: 0.2cm;
                border: 1px #FFFFFF solid;
                height: 257mm;
                outline: 2cm #FFFFFF solid;
            }
            .wide-page,
            .page {
                display: block;
                position: relative;
            }
            .wide-page:not(.no-watermark):after,
            .page:not(.no-watermark):after {
                content: "";
                background: url('/img/logo.jpg');
                background-position: center;
                background-repeat: no-repeat;
                opacity: 0.1;
                top: 0;
                left: 0;
                bottom: 0;
                right: 0;
                position: absolute;
                z-index: 99;
            }

            .col-6-print{
                flex:0 0 50% !important;
            }

            .col-3-print{
                flex:0 0 25% !important;
            }

            
            @page {
                size: A4;
                margin: 0;
            }

            @media print {
                html, body {
                    width: 210mm;
                    height: 297mm;        
                }
                .page {
                    margin: 0;
                    border: initial;
                    border-radius: initial;
                    width: initial;
                    min-height: initial;
                    box-shadow: initial;
                    background: initial;
                    page-break-after: always;
                }
            }
            .a {
                text-indent: 2em;
            }
            .row-eq-height {
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display:         flex;
            }
            .row.display-flex {
                display: flex;
                flex-wrap: wrap;
            }
            .row.display-flex > [class*='col-'] {
                display: flex;
                flex-direction: column;
            }
            
    body.gray-bg
        .book
            .page.no-watermark
                .subpage
                    .row
                        .col-md-12.text-center(style='margin-top: 150px;')
                            img(src='/img/rias.jpg', style='max-width: 100%; height: 150px;')
                        .col-md-12.text-center(style='margin-top: 50px;')
                            h3(style='font-size: 40px;') 로르샤하 해석 지원 시스템
                            h4(style='font-size: 20px;')
                                | The Rorschach Interpretation
                                br
                                | Assistance System
                        .col-md-12.text-center(style='margin-top: 30px;')
                            table.table.table-bordered(style='width: 500px; margin: 0 auto;')
                                tbody
                                    tr
                                        td(style='width: 100px;').text-center 검사기관
                                        td.text-center= testconfig.comName_input
                                    tr
                                        td.text-center 검 사 자
                                        td.text-center= testconfig.inspector 
                        .col-md-12.text-right
                            img(src='/img/logo.jpg', style='height: 100px; margin-top: 50px; margin-right: 50px;')
            .page
                .subpage#page0
                    .row
                        .col-md-12.text-center
                            h3 Rorschach Test Sequence of Scores
                    .container-fluid
                        .row
                            .col-md-12.text-center
                                h6(style='font-size: 11px;') NO : #{testconfig.id} &nbsp&nbsp&nbsp&nbsp 이름 : #{testconfig.name} &nbsp&nbsp&nbsp&nbsp 성별 : #{testconfig.sex} &nbsp&nbsp&nbsp&nbsp 생년월일 : #{moment(testconfig.birthday).format('YYYY년 MM월 DD일')}(만 #{testconfig.age}세) &nbsp&nbsp&nbsp&nbsp 검사일 : #{moment(testconfig.testdate).format('YYYY년 MM월 DD일')}
                            
                    .row
                        .col-md-12.text-center
                            table.table.table-bordered.table-minh
                                thead
                                    tr(style='font-size: 7px;')
                                        th.text-center(style='width: 35px;') 카드
                                        th.text-center(style='width: 35px;') 번호
                                        th.text-center(style='width: 35px;') 위치
                                        th.text-center(style='width: 35px;') DQ
                                        th.text-center(style='min-width: 100px;') 결정인
                                        th.text-center(style='width: 35px;') FQ
                                        th.text-center(style='width: 35px;') (2)
                                        th.text-center(style='min-width: 100px;') 반응내용
                                        th.text-center(style='width: 35px;')  P
                                        th.text-center(style='width: 50px;')  Z
                                        th.text-center(style='min-width: 100px;')  특수점수
                                tbody
                                    each score, index in scores.slice(0, 27)
                                        tr(style='font-size: 11px;')
                                            td
                                                if score.card==1
                                                    = "Ⅰ"
                                                else if score.card==2
                                                    = "Ⅱ"
                                                else if score.card==3
                                                    = "Ⅲ"
                                                else if score.card==4
                                                    = "Ⅳ"
                                                else if score.card==5
                                                    = "Ⅴ"
                                                else if score.card==6
                                                    = "Ⅵ"
                                                else if score.card==7
                                                    = "Ⅶ"
                                                else if score.card==8
                                                    = "Ⅷ"
                                                else if score.card==9
                                                    = "Ⅸ"
                                                else if score.card==10
                                                    = "Ⅹ"
                                            td
                                                if score.card
                                                    = index + 1
                                            td= score.loc
                                            td= score.dq
                                            td.text-justify!= score.det
                                            td= score.fq
                                            td= score.select2
                                            td.text-justify= score.react
                                            td= score.p
                                            td= score.z
                                            td.text-justify= score.score
            if scores[27].card
                .page
                    .subpage#page0
                        .row
                            .col-md-12.text-center
                                h3 Rorschach Test Sequence of Scores
                        .container-fluid
                            .row
                                .col-md-12.text-center
                                    h6(style='font-size: 11px;') NO : #{testconfig.id} &nbsp&nbsp&nbsp&nbsp 이름 : #{testconfig.name} &nbsp&nbsp&nbsp&nbsp 성별 : #{testconfig.sex} &nbsp&nbsp&nbsp&nbsp 생년월일 : #{moment(testconfig.birthday).format('YYYY년 MM월 DD일')}(만 #{testconfig.age}세) &nbsp&nbsp&nbsp&nbsp 검사일 : #{moment(testconfig.testdate).format('YYYY년 MM월 DD일')}
                        .row
                            .col-md-12.text-center
                                table.table.table-bordered.table-minh
                                    thead
                                        tr(style='font-size: 7px;')
                                            th.text-center(style='width: 35px;') 카드
                                            th.text-center(style='width: 35px;') 번호
                                            th.text-center(style='width: 35px;') 위치
                                            th.text-center(style='width: 35px;') DQ
                                            th.text-center(style='min-width: 100px;') 결정인
                                            th.text-center(style='width: 35px;') FQ
                                            th.text-center(style='width: 35px;') (2)
                                            th.text-center(style='min-width: 100px;') 반응내용
                                            th.text-center(style='width: 35px;')  P
                                            th.text-center(style='width: 50px;')  Z
                                            th.text-center(style='min-width: 100px;')  특수점수
                                    tbody
                                        each score, index in scores.slice(27)
                                            tr(style='font-size: 11px;')
                                                td
                                                    if score.card==1
                                                        = "Ⅰ"
                                                    else if score.card==2
                                                        = "Ⅱ"
                                                    else if score.card==3
                                                        = "Ⅲ"
                                                    else if score.card==4
                                                        = "Ⅳ"
                                                    else if score.card==5
                                                        = "Ⅴ"
                                                    else if score.card==6
                                                        = "Ⅵ"
                                                    else if score.card==7
                                                        = "Ⅶ"
                                                    else if score.card==8
                                                        = "Ⅷ"
                                                    else if score.card==9
                                                        = "Ⅸ"
                                                    else if score.card==10
                                                        = "Ⅹ"
                                                td
                                                    if score.card
                                                        = index + 26
                                                td= score.loc
                                                td= score.dq
                                                td!= score.det
                                                td= score.fq
                                                td= score['(2)']
                                                td= score.react
                                                td= score.p
                                                td= score.z
                                                td= score.score
                                        

            .page
                .subpage#page1: div(style='margin-top: -10mm;')
                    .row
                        .col-md-12.text-center
                            h3 Rorschach Test Structural Summary
                    //-.container-fluid
                        .row
                            .col-md-12.text-center
                                h6 NO : #{testconfig.id} &nbsp&nbsp&nbsp&nbsp 이름 : #{testconfig.name} &nbsp&nbsp&nbsp&nbsp 생년월일 : #{moment(testconfig.birthday).format('YYYY년 MM월 DD일')}(만 #{testconfig.age}세) &nbsp&nbsp&nbsp&nbsp 성별 : #{testconfig.sex} &nbsp&nbsp&nbsp&nbsp 검사일 : #{moment(testconfig.testdate).format('YYYY년 MM월 DD일')}
                    .row
                        .col-md-3.col-3-print(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="3") 반응위치 특징
                                            br
                                            | (Location Features)
                                tbody
                                    tr
                                        td(style="font-size: 7pt;")
                                            .text-center 조직화 활동
                                            div(style="margin-left: 10px;")
                                                span(style='display: inline-block; width: 30px;') Zf
                                                | = #{upper.location_features.Zf}
                                                br
                                                span(style='display: inline-block; width: 30px;') ZSum
                                                //| = #{(upper.location_features.ZSum).toFixed(1)}
                                                | = #{roundTo(upper.location_features.ZSum, 1)}
                                                br
                                                if upper.location_features.ZEst
                                                    span(style='display: inline-block; width: 30px;') ZEst
                                                    | = 
                                                    | #{roundTo(upper.location_features.ZEst, 1)}
                                    tr
                                        td(style="font-size: 7pt;")
                                            .text-center 반응 위치
                                            div(style="margin-left: 10px;")
                                                span(style='display: inline-block; width: 30px;') W
                                                | = #{upper.location_features.W}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( Wv 
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.location_features.Wv}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') D
                                                | = #{upper.location_features.D}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( W+D
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.location_features.WPlusD}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') Dd
                                                | = #{upper.location_features.Dd}
                                                br
                                                span(style='display: inline-block; width: 30px;') S
                                                | = #{upper.location_features.S}
                            
                            table.table.table-bordered
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="3") 발달질
                                            br
                                            | (Developmental Quality)
                                tbody
                                    tr
                                        td(style="font-size: 7pt;")
                                            div(style="margin-left: 10px;")
                                                span(style='display: inline-block; width: 30px;') +
                                                | = #{upper.dq.plus}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.plusFQxminus}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') o
                                                | = #{upper.dq.o}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.oFQxminus}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') v/+
                                                | = #{upper.dq.VSlashPlus}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.vSlashPlusFQxminus}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') v
                                                | = #{upper.dq.v}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.vFQxminus}
                                                    | )
                                                br
                                                br
                                                br
                                                br
                                                br
                                                br
                                                br

                        .col-md-3.col-3-print(style="padding-right: 2px; padding-left: 2px; padding-right: 1px;")
                            table.table.table-bordered(style='margin-bottom: 0; border-bottom: 0;')
                                thead
                                    tr(style='border-bottom-width: 0;')
                                        th.td-small.text-center(style="font-size: 7pt; border-bottom: 0;" colspan="3") 결정인
                                            br
                                            | (Determinants)
                            .col-md-8(style='margin: 0; padding: 0;')
                                table.table.table-bordered(style='border-right: 0; margin: 0;border-bottom: 0;')
                                    tbody
                                        tr
                                            td(style="font-size: 7pt; border-right: 0; border-bottom: 0; height: 350px;" colspan="1.5")
                                                .text-center 복합
                                                    br
                                                    | (Blends)
                                                div
                                                    each blends in upper.blends
                                                        div
                                                            each blend, index in blends
                                                                span !{blend}
                                                                if index != blends.length - 1
                                                                    |.
                                                                span &nbsp;
                            .col-md-4(style='margin: 0; padding: 0')
                                table.table.table-bordered(style='margin-bottom: 0;')
                                    tbody
                                        tr
                                            td(style="font-size: 7pt; margin-right: 0; padding-right: 0; padding-left: 8px;" colspan="1.5")
                                                .text-center(style='padding-right: 8px;') 전체
                                                    br
                                                    | (Total)
                                                div
                                                    span(style='display: inline-block; width: 15px;') F
                                                    | = #{upper.determinants.F}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') M
                                                    | = #{upper.determinants.M}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FM
                                                    | = #{upper.determinants.FM}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') m
                                                    | = #{upper.determinants.m}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FC
                                                    | = #{upper.determinants.FC}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') CF
                                                    | = #{upper.determinants.CF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') C
                                                    | = #{upper.determinants.C}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') Cn
                                                    | = #{upper.determinants.Cn}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FC'
                                                    | = #{upper.determinants.FCprime}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') C'F
                                                    | = #{upper.determinants.CprimeF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') C'
                                                    | = #{upper.determinants.Cprime}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FY
                                                    | = #{upper.determinants.FY}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') YF
                                                    | = #{upper.determinants.YF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') Y
                                                    | = #{upper.determinants.Y}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FT
                                                    | = #{upper.determinants.FT}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') TF
                                                    | = #{upper.determinants.TF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') T
                                                    | = #{upper.determinants.T}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FV
                                                    | = #{upper.determinants.FV}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') VF
                                                    | = #{upper.determinants.VF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') V
                                                    | = #{upper.determinants.V}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FD
                                                    | = #{upper.determinants.FD}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') Fr
                                                    | = #{upper.determinants.Fr}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') rF
                                                    | = #{upper.determinants.rF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') (2)
                                                    | = #{upper.determinants.two}
                                                    br
                                                    br
                                                    br
                                                    br
                                                    br
                                                    //- br
                                                    //- | P = #{upper.determinants.P}
                        .col-md-2.col-2-print(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt;" colspan="3") 반응내용
                                            br
                                            | (Contents)
                                tbody
                                    tr
                                        td(style="font-size: 7pt;" colspan="3")
                                            div(style="margin-left: 0px;")
                                                - var order = ['H', '(H)', 'Hd', '(Hd)', 'Hx', 'A', '(A)', 'Ad', '(Ad)', 'An', 'Xy', 'Bl', 'Sx', 'Sc', 'Art', 'Ay', 'Hh', 'Fd', 'Cg', 'Na', 'Bt', 'Ls', 'Ge', 'Cl', 'Fi', 'Ex', 'Id', 'P']
                                                each key in order
                                                    span(style='display: inline-block; width: 23px;') #{key}
                                                    | = #{upper.contents[key]}
                                                    br
                                                    if key == 'Hx' || key=='(Ad)' || key == 'Sx' || key == 'Cg' || key == 'Ex'
                                                        br
                                            br
                                    
                        .col-md-4.col-3-print(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="3") 접근방식
                                            br
                                            | (Summary of Approach)
                                tbody
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") 카드
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="3") 위치와 발달질
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅰ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")= upper.approach[1].slice(0, 6).join(', ')
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅱ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")= upper.approach[2].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅲ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[3].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅳ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[4].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅴ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[5].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅵ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[6].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅶ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[7].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅷ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[8].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅸ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[9].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅹ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[10].slice(0, 6).join(', ')
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="24") 특수점수
                                            br
                                            | (Special Scores)
                                tbody(style="font-size: 7pt")
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                        td.text-center(style="padding: 2px;" colspan="9") LV1
                                        td.text-center(style="padding: 2px;" colspan="9") LV2
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') DV
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DV1} × 1 (#{upper.special_scores.DV1*1})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DV2} × 2 (#{upper.special_scores.DV2*2})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') INCOM
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.INCOM1} × 2 (#{upper.special_scores.INCOM1*2})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.INCOM2} × 4 (#{upper.special_scores.INCOM2*4})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') DR
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DR1} × 3 (#{upper.special_scores.DR1*3})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DR2} × 6 (#{upper.special_scores.DR2*6})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') FABCOM
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.FABCOM1} × 4 (#{upper.special_scores.FABCOM1*4})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.FABCOM2} × 7 (#{upper.special_scores.FABCOM2*7})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') ALOG
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.ALOG} × 5 (#{upper.special_scores.ALOG*5})
                                        td.text-center(style="padding: 2px;" colspan="9")
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') CONTAM
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.CONTAM} × 7 (#{upper.special_scores.CONTAM*7})
                                        td.text-center(style="padding: 2px;" colspan="9")
                                thead(style="font-size: 7pt")
                                    tr
                                        th.td-small.text-center(style="padding-top: 5px !important;" colspan="24") Sum6 = #{upper.special_scores.Sum6} &nbsp;&nbsp; WSum6 = #{upper.special_scores.WSum6}
                                tbody(style="font-size: 7pt")
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12")
                                            span(style='display: inline-block; width: 25px;') AG
                                            | = #{upper.special_scores.AG}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') AB
                                            | = #{upper.special_scores.AB}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') COP
                                            | = #{upper.special_scores.COP}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') CP
                                            | = #{upper.special_scores.CP}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') GHR
                                            | = #{upper.special_scores.GHR}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') MOR
                                            | = #{upper.special_scores.MOR}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') PHR
                                            | = #{upper.special_scores.PHR}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') PSV
                                            | = #{upper.special_scores.PSV}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') PER
                                            | = #{upper.special_scores.PER}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            
                    .row
                        .col-md-5(style="padding-right: 0px; padding-left: 0px; margin-top: -148px; margin-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="4") 형태질
                                            br
                                            | (Form Quality)
                                tbody(style="font-size: 7pt")
                                    tr
                                        td.text-center(style="padding: 2px;")
                                        td.text-center(style="padding: 2px;") FQx
                                        td.text-center(style="padding: 2px;") MQuality
                                        td.text-center(style="padding: 2px;") W+D
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') +
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['+']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['+']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['+']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') o
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['o']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['o']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['o']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') u
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['u']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['u']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['u']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') -
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['-']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['-']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['-']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') none
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['none']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['none']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['none']}
                        

                    .row
                        .col-md-12(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.text-center 비율(RAIOS), 백분율(PERCENTAGES), 산출한 점수(DERIVATIONS)
                    
                    .row.display-flex
                        .col-md-5(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered.h-100(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 핵심 영역
                                            br
                                            | (CORE)
                                tbody
                                    tr
                                        td(colspan="8" )
                                            span(style='display: inline-block; width: 15px;') R
                                            | = #{lower.core.R}
                                        td(colspan="8") 
                                            | Lambda(L) = #{lower.core.Lambda}
                                        td(colspan='4')
                                            if lower.core.LambdaHighOrLow == 'High'
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | High
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | High
                                            br
                                            if lower.core.LambdaHighOrLow == 'Low'
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | Low
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | Low
                                    tr
                                        td(colspan="8")
                                            span(style='display: inline-block; width: 15px;') EB
                                            //-| = #{lower.core.EBLeft}:#{(lower.core.EBRight).toFixed(1)}
                                            | = #{lower.core.EBLeft}:#{roundTo(lower.core.EBRight, 1)}
                                            br
                                            span(style='display: inline-block; width: 15px;') eb
                                            | = #{lower.core.ebLeft}:#{lower.core.ebRight}
                                        td(colspan="8") 
                                            span(style='display: inline-block; width: 35px;') EA
                                            | = #{roundTo(lower.core.EA, 1)}
                                            br
                                            span(style='display: inline-block; width: 35px;') es
                                            | = #{lower.core.es}
                                            br
                                            span(style='display: inline-block; width: 35px;') Adj es
                                            | = #{lower.core.Adjes}
                                        td(colspan="8") 
                                            span(style='display: inline-block; width: 35px;') EBPer
                                            | = #{lower.core.EBPer}
                                            br
                                            span(style='display: inline-block; width: 35px;') D
                                            | = #{lower.core.D}
                                            br
                                            span(style='display: inline-block; width: 35px;') Adj D
                                            | = #{lower.core.AdjD}
                                    tr
                                        td(colspan="8") 
                                            span(style='display: inline-block; width: 15px;') FM
                                            | = #{lower.core.FM}
                                            br
                                            span(style='display: inline-block; width: 15px;') m
                                            | = #{lower.core.m}
                                        td(colspan="8")
                                            span(style='display: inline-block; width: 35px;') Sum C'
                                            | = #{lower.core.SumCprime}
                                            br
                                            span(style='display: inline-block; width: 35px;') Sum V
                                            | = #{lower.core.SumV}
                                        td(colspan="8")
                                            span(style='display: inline-block; width: 35px;') Sum T
                                            | = #{lower.core.SumT}
                                            br
                                            span(style='display: inline-block; width: 35px;') Sum Y
                                            | = #{lower.core.SumY}
                        
                        .col-md-3(style="padding-right: 2px; padding-left: 2px; width: 29.16%")
                            table.table.table-bordered.h-100(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 정서 영역
                                            br
                                            | (AFFECT)
                                tbody
                                    tr
                                        td(colspan="20", style='padding-right: 0; padding-left: 4px')
                                            span(style='display: inline-block; width: 100px;') FC : CF+C
                                            | = #{lower.affection.FCCFCLeft} : #{lower.affection.FCCFCRight}
                                            br
                                            span(style='display: inline-block; width: 100px;') Pure C
                                            | = #{lower.affection.PureC}
                                            br
                                            span(style='display: inline-block; width: 100px;') SumC' : WSumC
                                            //-| = #{lower.affection.SumCprime} : #{lower.affection.WSumC.toFixed(1)}
                                            | = #{lower.affection.SumCprime} : #{roundTo(lower.affection.WSumC, 1)}
                                            br
                                            span(style='display: inline-block; width: 100px;') Affective Ratio (Afr)
                                            | = #{lower.affection.Afr}
                                            br
                                            span(style='display: inline-block; width: 100px;') S
                                            | = #{lower.affection.S}
                                            br
                                            span(style='display: inline-block; width: 100px;') Blends : R
                                            //-| = #{lower.affection.Blends} : #{lower.affection.R} (#{(lower.affection.Blends * 100 / lower.affection.R).toFixed(0)}%)
                                            | = #{lower.affection.Blends} : #{lower.affection.R} (#{roundTo(lower.affection.Blends * 100 / lower.affection.R, 0)}%)
                                            br
                                            span(style='display: inline-block; width: 100px;') Color Projection (CP)
                                            | = #{lower.affection.CP}

                        .col-md-4(style="padding-right: 2px; padding-left: 2px; width: 29.16%")
                            table.table.table-bordered.h-100(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 대인 지각 영역
                                            br
                                            | (INTERPERSONAL PERCEPTION)
                                tbody
                                    tr
                                        td(colspan="12")
                                            span(style='display: inline-block; width: 100px;') COP
                                            | = #{lower.interpersonal.COP}
                                            br
                                            span(style='display: inline-block; width: 100px;') AG
                                            | = #{lower.interpersonal.AG}
                                            br
                                            span(style='display: inline-block; width: 100px;') GHR : PHR
                                            | = #{lower.interpersonal.GHR} : #{lower.interpersonal.PHR}
                                            br
                                            span(style='display: inline-block; width: 100px;') active : passive (a:p)
                                            | = #{lower.interpersonal.a} : #{lower.interpersonal.p}
                                            br
                                            span(style='display: inline-block; width: 100px;') Food (Fd)
                                            | = #{lower.interpersonal.Food}
                                            br
                                            span(style='display: inline-block; width: 100px;') SumT
                                            | = #{lower.interpersonal.SumT}
                                            br
                                            span(style='display: inline-block; width: 100px;') Human Contents
                                            | = #{lower.interpersonal.HumanCont}
                                            br
                                            span(style='display: inline-block; width: 100px;') Pure H
                                            | = #{lower.interpersonal.PureH}
                                            br
                                            span(style='display: inline-block; width: 100px;') PER
                                            | = #{lower.interpersonal.PER}
                                            br
                                            span(style='display: inline-block; width: 100px;') Isolation Index
                                            | = #{lower.interpersonal.ISOIndex}
                    .row.display-flex
                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 관념화 영역
                                            br
                                            | (IDEATION)
                                tbody
                                    tr
                                        td(colspan="16")
                                            span(style='display: inline-block; width: 100px;') active : passive (a:p)
                                            | = #{lower.ideation.a} : #{lower.ideation.p}
                                            br
                                            span(style='display: inline-block; width: 100px;') M<sup>a</sup> : M<sup>p</sup>
                                            | = #{lower.ideation.Ma} : #{lower.ideation.Mp}
                                            br
                                            span(style='display: inline-block; width: 100px;') Intellectual Index
                                            | = #{lower.ideation.twoABplusArtplusAy}
                                            br
                                            span(style='display: inline-block; width: 100px;') MOR
                                            | = #{lower.ideation.MOR}
                                            br
                                            span(style='display: inline-block; width: 100px;') Sum6
                                            | = #{lower.ideation.Sum6}
                                            br
                                            span(style='display: inline-block; width: 100px;') Lv2 Special Scores
                                            | = #{lower.ideation.Lv2}
                                            br
                                            span(style='display: inline-block; width: 100px;') WSum6
                                            | = #{lower.ideation.WSum6}
                                            br
                                            span(style='display: inline-block; width: 100px;') M-
                                            | = #{lower.ideation.Mminus}
                                            br
                                            span(style='display: inline-block; width: 100px;') M none
                                            | = #{lower.ideation.Mnone}


                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 인지적 중재 영역
                                            br
                                            | (COGNITIVE MEDIATION)
                                tbody
                                    tr
                                        td(colspan="12") 
                                            span(style='display: inline-block; width: 70px;') XA%
                                            | = #{lower.cognitive_mediation.XAper}
                                            br
                                            span(style='display: inline-block; width: 70px;') XDA%
                                            | = #{lower.cognitive_mediation.WDAper}
                                            br
                                            span(style='display: inline-block; width: 70px;') X-%
                                            //-| = #{lower.cognitive_mediation.Xminusper.toFixed(2)}
                                            | = #{roundTo(lower.cognitive_mediation.Xminusper, 2)}
                                            br
                                            span(style='display: inline-block; width: 70px;') S-
                                            | = #{lower.cognitive_mediation.Sminus}
                                            br
                                            span(style='display: inline-block; width: 70px;') Popular (P)
                                            | = #{lower.cognitive_mediation.P}
                                            br
                                            span(style='display: inline-block; width: 70px;') X+%
                                            | = #{lower.cognitive_mediation.Xplusper}
                                            br
                                            span(style='display: inline-block; width: 70px;') Xu%
                                            | = #{lower.cognitive_mediation.Xuper}


                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24", style='padding-left: 0; padding-right: 0;') 정보 처리 영역
                                            br
                                            | (INFORMATION PROCESSING)
                                tbody
                                    tr
                                        td(colspan="12")
                                            span(style='display: inline-block; width: 60px;') Zf
                                            | = #{lower.information_processing.Zf}
                                            br
                                            span(style='display: inline-block; width: 60px;') W : D : Dd
                                            | = #{lower.information_processing.W} : #{lower.information_processing.D} : #{lower.information_processing.Dd}
                                            br
                                            span(style='display: inline-block; width: 60px;') W : M
                                            | = #{lower.information_processing.W} : #{lower.information_processing.M}
                                            br
                                            span(style='display: inline-block; width: 60px;') Zd
                                            | = 
                                            +parseSign(lower.information_processing.Zd)
                                            br
                                            span(style='display: inline-block; width: 60px;') PSV
                                            | = #{lower.information_processing.PSV}
                                            br
                                            span(style='display: inline-block; width: 60px;') DQ+
                                            | = #{lower.information_processing.DQplus}
                                            br
                                            span(style='display: inline-block; width: 60px;') DQv
                                            | = #{lower.information_processing.DQv}


                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 자기 지각 영역
                                            br
                                            | (SELF-PERCEPTION)
                                tbody
                                    tr
                                        td(colspan="12")
                                            span(style='display: inline-block; width: 90px;') Egocentricity Index
                                            | = #{lower.self_perception.EgocentricityIndex}
                                            br
                                            span(style='display: inline-block; width: 90px;') Reflections (Fr+rf)
                                            | = #{lower.self_perception.Reflections}
                                            br
                                            span(style='display: inline-block; width: 90px;') SumV
                                            | = #{lower.self_perception.SumV}
                                            br
                                            span(style='display: inline-block; width: 90px;') FD
                                            | = #{lower.self_perception.FD}
                                            br
                                            span(style='display: inline-block; width: 90px;') An+Xy
                                            | = #{lower.self_perception.AnPlusXy}
                                            br
                                            span(style='display: inline-block; width: 90px;') MOR
                                            | = #{lower.self_perception.MOR}
                                            br
                                            span(style='display: inline-block; width: 90px;') H : (H)+Hd+(Hd)
                                            | = #{lower.self_perception.H} : #{lower.self_perception.Hrest}

                    .row
                        .col-md-12(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt;")
                                thead
                                    tr
                                        th.text-center(colspan="4")
                                            if lower.special_indices.SCONPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | S-CON = YES(#{lower.special_indices.SCON})
                                            else
                                                if lower.special_indices.SCON == -1
                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                    | S-CON = N/A
                                                else
                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                    | S-CON = NO(#{lower.special_indices.SCON})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.PTI>=4
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | PTI = YES(#{lower.special_indices.PTI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | PTI = NO(#{lower.special_indices.PTI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.DEPIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | DEPI = YES(#{lower.special_indices.DEPI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | DEPI = NO(#{lower.special_indices.DEPI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.CDIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | CDI = YES(#{lower.special_indices.CDI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | CDI = NO(#{lower.special_indices.CDI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.HVIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | HVI = YES
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | HVI = NO
                                        th.text-center(colspan="4")
                                            if lower.special_indices.OBSPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | OBS = YES
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | OBS = NO

                                            
            .page
                .subpage#page3
                    .row
                        .col-md-12.text-center
                            h3 특수지표 (Constellation Worksheet)

                    .row
                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 360px;")
                            table.table.table-bordered(style="font-size: 7pt; margin-bottom: 0; height: 100%;")
                                thead
                                    tr
                                        th.text-center S-Constellation (Suicide Potential) : 만 14세 이상만 적용
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight:bold;")
                                                if SpecialIndices.S_Constellation.Up8Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if 8 or more conditions are true
                                            
                                            p
                                                if SpecialIndices.S_Constellation.SumVplusFD
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;SumV + FD > 2
                                            p
                                                if SpecialIndices.S_Constellation.ColorShadingBlends
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Color-Shading Blends > 0
                                            p
                                                if SpecialIndices.S_Constellation.Ego
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Egocentricity Index < 0.31 or Egocentricity Index > 0.44
                                            p
                                                if SpecialIndices.S_Constellation.MOR
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;MOR > 3
                                            p
                                                if SpecialIndices.S_Constellation.Zd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Zd > +3.5) or (Zd < -3.5)
                                            p
                                                if SpecialIndices.S_Constellation.es
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;es > EA
                                            p
                                                if SpecialIndices.S_Constellation.CF
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;CF + C > FC
                                            p
                                                if SpecialIndices.S_Constellation.XPlus
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;X+% < 0.70
                                            p
                                                if SpecialIndices.S_Constellation.S
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;S > 3
                                            p
                                                if SpecialIndices.S_Constellation.P
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Populars(P) < 3) or (Populars(P) > 8)
                                            p
                                                if SpecialIndices.S_Constellation.PureH
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Pure H < 2
                                            p
                                                if SpecialIndices.S_Constellation.R
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;R < 17

                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 360px;")
                            table.table.table-bordered(style="font-size: 7pt; margin-bottom: 0; height: 100%;")
                                thead
                                    tr
                                        th.text-center PTI (Perceptual Thinking Index)
                                        - var PTITotal = 0
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p
                                                if SpecialIndices.PTI.XAper
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(XA% < 0.70) and (WDA% < 0.75)
                                            p
                                                if SpecialIndices.PTI.Xminusper
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;X-% > 0.29
                                            p
                                                if SpecialIndices.PTI.Level2
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Sum Level2 Special Score > 2) and (FABCOM Level2 > 0)
                                            p
                                                span(style='margin-left: -6px;') *
                                                if SpecialIndices.PTI.R
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age >= 5 && testconfig.age <= 7
                                                    | &nbsp;{(R < 17) and (WSum6 > 16)} or {(R > 16) and (WSum6 > 20)}
                                                else if testconfig.age >= 8 && testconfig.age <= 10
                                                    | &nbsp;{(R < 17) and (WSum6 > 15)} or {(R > 16) and (WSum6 > 19)}
                                                else if testconfig.age >= 11 && testconfig.age <= 13
                                                    | &nbsp;{(R < 17) and (WSum6 > 14)} or {(R > 16) and (WSum6 > 18)}
                                                else
                                                    | &nbsp;{(R < 17) and (WSum6 > 12)} or {(R > 16) and (WSum6 > 17)}
                                            p
                                                if SpecialIndices.PTI.M
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(M- > 1) or (X-% > 0.40)
                                            P(style="font-weight: bold;")="Total = " + PTITotal.toString()

                    
                    .row
                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 250px;")
                            table.table.table-bordered(style="font-size: 7pt;height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center DEPI (Depression Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.DEPI.Up5Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if 5 or more conditions are true
                                            p
                                                if SpecialIndices.DEPI.FV
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(SumV > 0) or (FD > 2)
                                            p
                                                if SpecialIndices.DEPI.ColorShadingBlends
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Color-Shading Blends > 0) or (S > 2)
                                            p
                                                span(style='margin-left: -6px;') *
                                                if SpecialIndices.DEPI.Ego
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age == 5
                                                    | &nbsp;(Egocentricity Index > 0.83 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.55)
                                                else if testconfig.age == 6
                                                    | &nbsp;(Egocentricity Index > 0.82 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.52)
                                                else if testconfig.age == 7
                                                    | &nbsp;(Egocentricity Index > 0.77 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.52)
                                                else if testconfig.age == 8
                                                    | &nbsp;(Egocentricity Index > 0.74 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.48)
                                                else if testconfig.age == 9
                                                    | &nbsp;(Egocentricity Index > 0.69 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.45)
                                                else if testconfig.age == 10
                                                    | &nbsp;(Egocentricity Index > 0.63 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.45)
                                                else if testconfig.age == 11
                                                    | &nbsp;(Egocentricity Index > 0.58 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.45)
                                                else if testconfig.age == 12
                                                    | &nbsp;(Egocentricity Index > 0.58 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.38)
                                                else if testconfig.age == 13
                                                    | &nbsp;(Egocentricity Index > 0.56 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.38)
                                                else if testconfig.age == 14
                                                    | &nbsp;(Egocentricity Index > 0.54 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.37)
                                                else if testconfig.age == 15
                                                    | &nbsp;(Egocentricity Index > 0.50 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.33)
                                                else if testconfig.age == 16
                                                    | &nbsp;(Egocentricity Index > 0.48 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.33)
                                                else
                                                    | &nbsp;(Egocentricity Index > 0.44 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.33)
                                            p
                                                span(style='margin-left: -6px;') *
                                                if SpecialIndices.DEPI.Afr
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age >= 5 && testconfig.age <= 6
                                                    | &nbsp;(Affective Ratio(Afr) < 0.57) or (Blends < 4)
                                                else if testconfig.age >= 7 && testconfig.age <= 9
                                                    | &nbsp;(Affective Ratio(Afr) < 0.55) or (Blends < 4)
                                                else if testconfig.age >= 10 && testconfig.age <= 13
                                                    | &nbsp;(Affective Ratio(Afr) < 0.53) or (Blends < 4)
                                                else
                                                    | &nbsp;(Affective Ratio(Afr) < 0.46) or (Blends < 4)
                                            p
                                                if SpecialIndices.DEPI.SumShading
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(SumShading > FM + m) or (SumC' > 2)
                                            p
                                                if SpecialIndices.DEPI.MOR
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(MOR > 2) or (Intellectualization Index > 3)
                                            p
                                                if SpecialIndices.DEPI.COP
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(COP < 2) or (Isolation Index > 0.24)

                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 250px;")
                            table.table.table-bordered(style="font-size: 7pt;height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center CDI (Coping Deficit Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.CDI.Up4Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if 4 or more conditions are true
                                            p
                                                if SpecialIndices.CDI.EA
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(EA < 6) or (Adj D < 0)
                                            p
                                                if SpecialIndices.CDI.COP
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(COP < 2) and (AG < 2)
                                            p
                                                if SpecialIndices.CDI.WSumC
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age >= 5 && testconfig.age <= 6
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.57)
                                                else if testconfig.age >= 7 && testconfig.age <= 9
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.55)
                                                else if testconfig.age >= 10 && testconfig.age <= 13
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.53)
                                                else
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.46)
                                            p
                                                if SpecialIndices.CDI.Passive
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Passive(p) > Active(a)+1) or (Pure H < 2)
                                            p
                                                if SpecialIndices.CDI.SumT
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Sum T > 1) or (Isloation Index > 0.24) or (Food > 0)
                                            p
                                                br
                                                br
                                                br
                    .row
                        .col-md-6(style="padding-right: 2px; padding-left: 2px; height: 320px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center HVI (Hypervigilance Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.HVI.Up4Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if (1) is true and at least 4 of the others are true
                                            p
                                                if SpecialIndices.HVI.FT
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;<u>(1) SumT = 0</u>
                                            p
                                                if SpecialIndices.HVI.Zf
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(2) Zf > 12
                                            p
                                                if SpecialIndices.HVI.Zd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(3) Zd > +3.5
                                            p
                                                if SpecialIndices.HVI.S
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(4) S > 3
                                            p
                                                if SpecialIndices.HVI.H
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(5) Human Content > 6
                                            p
                                                if SpecialIndices.HVI.ParH
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(6) (H) + (A) + (Hd) + (Ad) > 3
                                            p
                                                if SpecialIndices.HVI.HplusA
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(7) H + A : Hd + Ad < 4 : 1
                                            p
                                                if SpecialIndices.HVI.Cg
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(8) Cg > 3
                                            
                        .col-md-6(style="padding-right: 2px; padding-left: 2px; height: 320px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center OBS (Obsessive Style Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p
                                                if SpecialIndices.OBS.Dd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(1) Dd > 3
                                            p
                                                if SpecialIndices.OBS.Zf
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(2) Zf > 12
                                            p
                                                if SpecialIndices.OBS.Zd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(3) Zd > +3.0
                                            p
                                                if SpecialIndices.OBS.Populars
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(4) Populars(P) > 7
                                            p
                                                if SpecialIndices.OBS.FQplus
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(5) FQx+ > 1
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.OBS.Up1Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if one or more is true
                                            p
                                                if SpecialIndices.OBS.AllChecked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Conditions (1) to (5) are all true
                                            p
                                                if SpecialIndices.OBS.Up2Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;2 or more of (1) to (4) are true and (FQx+ > 3)
                                            p
                                                if SpecialIndices.OBS.Up3Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;3 or more of (1) to (5) are true and (X+% > 0.89)
                                            p
                                                if SpecialIndices.OBS.FQplusChecked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(FQx+ > 3) and (X+% > 0.89)
                    
                    
        script(src="/js/jquery-2.1.1.js")
        script(src="/js/bootstrap.min.js")
        script(src="/js/plugins/metisMenu/jquery.metisMenu.js")
        script(src="/js/plugins/slimscroll/jquery.slimscroll.min.js")
        script(src="/js/inspinia.js")
        script(src="/js/plugins/pace/pace.min.js")
        script(src="/js/plugins/flot/jquery.flot.js")
        script(src="/js/plugins/flot/jquery.flot.tooltip.min.js")
        script(src="/js/plugins/flot/jquery.flot.resize.js")
        script(src="/js/plugins/chartJs/Chart.min.js")
        script(src="/js/plugins/peity/jquery.peity.min.js")
        script(src="/js/demo/peity-demo.js")
        script(src="/js/plugins/fullcalendar/moment.min.js")
        script(src="/js/plugins/datapicker/bootstrap-datepicker.js")
        script(src="/js/plugins/daterangepicker/daterangepicker.js")
        script(src="/js/plugins/clockpicker/clockpicker.js")
        script(src="http://html2canvas.hertzen.com/dist/html2canvas.min.js")
        script.
            $(document).ready(function(){
                //window.print();
            })
            //- $(document).ready(function(){
            //-     html2canvas(document.querySelector("#page1")).then(canvas => {
            //-         var a = document.createElement('a');
            //-         // toDataURL defaults to png, so we need to request a jpeg, then convert for file download.
            //-         a.href = canvas.toDataURL("image/jpeg").replace("image/jpeg", "image/octet-stream");
            //-         a.download = 'page1.jpg';
            //-         a.click();
            //-     });
            //-     html2canvas(document.querySelector("#page2")).then(canvas => {
            //-         var a = document.createElement('a');
            //-         // toDataURL defaults to png, so we need to request a jpeg, then convert for file download.
            //-         a.href = canvas.toDataURL("image/jpeg").replace("image/jpeg", "image/octet-stream");
            //-         a.download = 'page2.jpg';
            //-         a.click();
            //-     });
            //-     html2canvas(document.querySelector("#page3")).then(canvas => {
            //-         var a = document.createElement('a');
            //-         // toDataURL defaults to png, so we need to request a jpeg, then convert for file download.
            //-         a.href = canvas.toDataURL("image/jpeg").replace("image/jpeg", "image/octet-stream");
            //-         a.download = 'page3.jpg';
            //-         a.click();
            //-     });
            //- })
