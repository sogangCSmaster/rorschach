doctype html
mixin parseSign(value)
    if value > 0
        | +
    = value
html
    head
        meta(charset="utf-8")
        meta(name="viewport" content="initial-scale=1.0")
        title Rorschach
        link(href="/css/bootstrap.min.css" rel="stylesheet" media="all")
        link(href="/font-awesome/css/font-awesome.css" rel="stylesheet" media="all")
        link(href="/css/animate.css" rel="stylesheet" media="all")
        link(href="/css/style.css" rel="stylesheet" media="all")
        link(href="/css/plugins/jasny/jasny-bootstrap.min.css" rel="stylesheet" media="all")
        link(href="/css/plugins/datapicker/datepicker3.css" rel="stylesheet" media="all")
        link(href="/css/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" media="all")
        link(href='/css/table-hover-cells.css', rel='stylesheet' media="all")
        link(href='/css/print.css', rel='stylesheet', media='print')
        //- link(rel="stylesheet" href="http://getbootstrap.com.vn/examples/equal-height-columns/equal-height-columns.css")
        style.
            ul {
                list-style: none;
                margin-left: 0;
                padding-left: 0;
            }
            li {
                text-align: left;
                padding-left: 1em;
                text-indent: -1em;
            }
            .indent {
                display: inline-block;
                margin-left: 40px;
            }
            li:before {
                content: '❊';
                padding-right: 5px;
            }
            .td-small {
                padding-top: 2px !important;
                padding-bottom: 2px !important;
            }
            body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
                background-color: #FAFAFA;
                font: 12pt "Tahoma";
            }
            * {
                box-sizing: border-box;
                -moz-box-sizing: border-box;
            }
            .page {
                width: 210mm;
                min-height: 297mm;
                display: block;
                margin: 10mm auto;
                box-sizing: border-box;
                padding: 20mm;
                border: 1px #D3D3D3 solid;
                border-radius: 5px;
                background: white;
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            }
            .wide-page {
                width: 210mm;
                min-height: 297mm;
                padding: 10mm;
                margin: 10mm auto;
                box-sizing: border-box;
                border: 1px #D3D3D3 solid;
                border-radius: 5px;
                background: white;
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            }
            .wide-subpage {
                padding: 0.2cm;
                border: 1px #FFFFFF solid;
                height: 277mm;
                outline: 1cm #FFFFFF solid;
            }
            .subpage {
                padding: 0.2cm;
                border: 1px #FFFFFF solid;
                height: 257mm;
                outline: 2cm #FFFFFF solid;
            }
            .wide-page,
            .page {
                display: block;
                position: relative;
            }
            .wide-page:not(.no-watermark):after,
            .page:not(.no-watermark):after {
                content: "";
                background: url('/img/logo.jpg');
                background-position: center;
                background-repeat: no-repeat;
                opacity: 0.1;
                top: 0;
                left: 0;
                bottom: 0;
                right: 0;
                position: absolute;
                z-index: 99;
            }

            .col-6-print{
                flex:0 0 50% !important;
            }

            .col-3-print{
                flex:0 0 25% !important;
            }

            
            @page {
                size: A4;
                margin: 0;
            }

            @media print {
                html, body {
                    width: 210mm;
                    height: 297mm;        
                }
                .page,
                .wide-page {
                    width: 210mm;
                    height: 297mm;
                    margin: 0;
                    border: initial;
                    border-radius: initial;
                    width: initial;
                    min-height: initial;
                    box-shadow: initial;
                    background: initial;
                    page-break-after: always;
                },
            }
            .a {
                text-indent: 2em;
            }
            .row-eq-height {
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display:         flex;
            }
            .row.display-flex {
                display: flex;
                flex-wrap: wrap;
            }
            .row.display-flex > [class*='col-'] {
                display: flex;
                flex-direction: column;
            }
            
    body.gray-bg
        .book
            .page.no-watermark
                .subpage
                    .row
                        .col-md-12.text-center(style='margin-top: 150px;')
                            img(src='/img/rias.jpg', style='max-width: 100%; height: 150px;')
                        .col-md-12.text-center(style='margin-top: 50px;')
                            h3(style='font-size: 40px;') 로르샤하 해석 지원 시스템
                            h4(style='font-size: 20px;')
                                | The Rorschach Interpretation
                                br
                                | Assistance System
                        .col-md-12.text-center(style='margin-top: 30px;')
                            table.table.table-bordered(style='width: 500px; margin: 0 auto;')
                                tbody
                                    tr
                                        td(style='width: 100px;').text-center 검사기관
                                        td.text-center= testconfig.comName_input
                                    tr
                                        td.text-center 검 사 자
                                        td.text-center= testconfig.inspector 
                        .col-md-12.text-right
                            img(src='/img/logo.jpg', style='height: 100px; margin-top: 50px; margin-right: 50px;')
            .page
                .subpage#page0
                    .row
                        .col-md-12.text-center
                            h3 Rorschach Test Sequence of Scores
                    .container-fluid
                        .row
                            .col-md-12.text-center
                                h6(style='font-size: 11px;') NO : #{testconfig.id} &nbsp&nbsp&nbsp&nbsp 이름 : #{testconfig.name} &nbsp&nbsp&nbsp&nbsp 성별 : #{testconfig.sex} &nbsp&nbsp&nbsp&nbsp 생년월일 : #{moment(testconfig.birthday).format('YYYY년 MM월 DD일')}(만 #{testconfig.age}세) &nbsp&nbsp&nbsp&nbsp 검사일 : #{moment(testconfig.testdate).format('YYYY년 MM월 DD일')}
                    .row
                        .col-md-12.text-center
                            table.table.table-bordered.table-minh
                                thead
                                    tr(style='font-size: 7px;')
                                        th.text-center(style='width: 35px;') 카드
                                        th.text-center(style='width: 35px;') 번호
                                        th.text-center(style='width: 35px;') 위치
                                        th.text-center(style='width: 35px;') DQ
                                        th.text-center(style='min-width: 100px;') 결정인
                                        th.text-center(style='width: 35px;') FQ
                                        th.text-center(style='width: 35px;') (2)
                                        th.text-center(style='min-width: 100px;') 반응내용
                                        th.text-center(style='width: 35px;')  P
                                        th.text-center(style='width: 50px;')  Z
                                        th.text-center(style='min-width: 100px;')  특수점수
                                tbody
                                    each score, index in scores.slice(0, 27)
                                        tr(style='font-size: 11px;')
                                            td
                                                if score.card==1
                                                    = "Ⅰ"
                                                else if score.card==2
                                                    = "Ⅱ"
                                                else if score.card==3
                                                    = "Ⅲ"
                                                else if score.card==4
                                                    = "Ⅳ"
                                                else if score.card==5
                                                    = "Ⅴ"
                                                else if score.card==6
                                                    = "Ⅵ"
                                                else if score.card==7
                                                    = "Ⅶ"
                                                else if score.card==8
                                                    = "Ⅷ"
                                                else if score.card==9
                                                    = "Ⅸ"
                                                else if score.card==10
                                                    = "Ⅹ"
                                            td
                                                if score.card
                                                    = index + 1
                                            td= score.loc
                                            td= score.dq
                                            td.text-justify!= score.det
                                            td= score.fq
                                            td= score.select2
                                            td.text-justify= score.react
                                            td= score.p
                                            td= score.z
                                            td.text-justify= score.score
            if scores[27].card
                .page
                    .subpage#page0
                        .row
                            .col-md-12.text-center
                                h3 Rorschach Test Sequence of Scores
                        .container-fluid
                            .row
                                .col-md-12.text-center
                                    h6(style='font-size: 11px;') NO : #{testconfig.id} &nbsp&nbsp&nbsp&nbsp 이름 : #{testconfig.name} &nbsp&nbsp&nbsp&nbsp 성별 : #{testconfig.sex} &nbsp&nbsp&nbsp&nbsp 생년월일 : #{moment(testconfig.birthday).format('YYYY년 MM월 DD일')}(만 #{testconfig.age}세) &nbsp&nbsp&nbsp&nbsp 검사일 : #{moment(testconfig.testdate).format('YYYY년 MM월 DD일')}
                        .row
                            .col-md-12.text-center
                                table.table.table-bordered.table-minh
                                    thead
                                        tr(style='font-size: 7px;')
                                            th.text-center(style='width: 35px;') 카드
                                            th.text-center(style='width: 35px;') 번호
                                            th.text-center(style='width: 35px;') 위치
                                            th.text-center(style='width: 35px;') DQ
                                            th.text-center(style='min-width: 100px;') 결정인
                                            th.text-center(style='width: 35px;') FQ
                                            th.text-center(style='width: 35px;') (2)
                                            th.text-center(style='min-width: 100px;') 반응내용
                                            th.text-center(style='width: 35px;')  P
                                            th.text-center(style='width: 50px;')  Z
                                            th.text-center(style='min-width: 100px;')  특수점수
                                    tbody
                                        each score, index in scores.slice(27)
                                            tr(style='font-size: 11px;')
                                                td
                                                    if score.card==1
                                                        = "Ⅰ"
                                                    else if score.card==2
                                                        = "Ⅱ"
                                                    else if score.card==3
                                                        = "Ⅲ"
                                                    else if score.card==4
                                                        = "Ⅳ"
                                                    else if score.card==5
                                                        = "Ⅴ"
                                                    else if score.card==6
                                                        = "Ⅵ"
                                                    else if score.card==7
                                                        = "Ⅶ"
                                                    else if score.card==8
                                                        = "Ⅷ"
                                                    else if score.card==9
                                                        = "Ⅸ"
                                                    else if score.card==10
                                                        = "Ⅹ"
                                                td
                                                    if score.card
                                                        = index + 26
                                                td= score.loc
                                                td= score.dq
                                                td!= score.det
                                                td= score.fq
                                                td= score['(2)']
                                                td= score.react
                                                td= score.p
                                                td= score.z
                                                td= score.score


            .page
                .subpage#page1: div(style='margin-top: -10mm;')
                    .row
                        .col-md-12.text-center
                            h3 Rorschach Test Structural Summary
                    //-.container-fluid
                        .row
                            .col-md-12.text-center
                                h6 NO : #{testconfig.id} &nbsp&nbsp&nbsp&nbsp 이름 : #{testconfig.name} &nbsp&nbsp&nbsp&nbsp 생년월일 : #{moment(testconfig.birthday).format('YYYY년 MM월 DD일')}(만 #{testconfig.age}세) &nbsp&nbsp&nbsp&nbsp 성별 : #{testconfig.sex} &nbsp&nbsp&nbsp&nbsp 검사일 : #{moment(testconfig.testdate).format('YYYY년 MM월 DD일')}
                    .row
                        .col-md-3.col-3-print(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="3") 반응위치 특징
                                            br
                                            | (Location Features)
                                tbody
                                    tr
                                        td(style="font-size: 7pt;")
                                            .text-center 조직화 활동
                                            div(style="margin-left: 10px;")
                                                span(style='display: inline-block; width: 30px;') Zf
                                                | = #{upper.location_features.Zf}
                                                br
                                                span(style='display: inline-block; width: 30px;') ZSum
                                                //-| = #{(upper.location_features.ZSum).toFixed(1)}
                                                | = #{roundTo(upper.location_features.ZSum, 1)}
                                                br
                                                if upper.location_features.ZEst
                                                    span(style='display: inline-block; width: 30px;') ZEst
                                                    | = 
                                                    | #{roundTo(upper.location_features.ZEst, 1)}
                                    tr
                                        td(style="font-size: 7pt;")
                                            .text-center 반응 위치
                                            div(style="margin-left: 10px;")
                                                span(style='display: inline-block; width: 30px;') W
                                                | = #{upper.location_features.W}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( Wv 
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.location_features.Wv}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') D
                                                | = #{upper.location_features.D}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( W+D
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.location_features.WPlusD}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') Dd
                                                | = #{upper.location_features.Dd}
                                                br
                                                span(style='display: inline-block; width: 30px;') S
                                                | = #{upper.location_features.S}
                            
                            table.table.table-bordered
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="3") 발달질
                                            br
                                            | (Developmental Quality)
                                tbody
                                    tr
                                        td(style="font-size: 7pt;")
                                            div(style="margin-left: 10px;")
                                                span(style='display: inline-block; width: 30px;') +
                                                | = #{upper.dq.plus}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.plusFQxminus}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') o
                                                | = #{upper.dq.o}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.oFQxminus}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') v/+
                                                | = #{upper.dq.VSlashPlus}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.vSlashPlusFQxminus}
                                                    | )
                                                br
                                                span(style='display: inline-block; width: 30px;') v
                                                | = #{upper.dq.v}
                                                span(style='display: inline-block; width: 70px; float: right; text-align: right;')
                                                    span(style='display: inline-block; width: 40px; float: left; text-align: left; padding-left: 5px;') ( FQx-
                                                    span(style='float: left; text-align: left')
                                                        | = #{upper.dq.vFQxminus}
                                                    | )
                                                br
                                                br
                                                br
                                                br
                                                br
                                                br
                                                br

                        .col-md-3.col-3-print(style="padding-right: 2px; padding-left: 2px; padding-right: 1px;")
                            table.table.table-bordered(style='margin-bottom: 0; border-bottom: 0;')
                                thead
                                    tr(style='border-bottom-width: 0;')
                                        th.td-small.text-center(style="font-size: 7pt; border-bottom: 0;" colspan="3") 결정인
                                            br
                                            | (Determinants)
                            .col-md-8(style='margin: 0; padding: 0;')
                                table.table.table-bordered(style='border-right: 0; margin: 0;border-bottom: 0;')
                                    tbody
                                        tr
                                            td(style="font-size: 7pt; border-right: 0; border-bottom: 0; height: 350px;" colspan="1.5")
                                                .text-center 복합
                                                    br
                                                    | (Blends)
                                                div
                                                    each blends in upper.blends
                                                        div
                                                            each blend, index in blends
                                                                span !{blend}
                                                                if index != blends.length - 1
                                                                    |.
                                                                span &nbsp;
                            .col-md-4(style='margin: 0; padding: 0')
                                table.table.table-bordered(style='margin-bottom: 0;')
                                    tbody
                                        tr
                                            td(style="font-size: 7pt; margin-right: 0; padding-right: 0; padding-left: 8px;" colspan="1.5")
                                                .text-center(style='padding-right: 8px;') 전체
                                                    br
                                                    | (Total)
                                                div
                                                    span(style='display: inline-block; width: 15px;') F
                                                    | = #{upper.determinants.F}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') M
                                                    | = #{upper.determinants.M}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FM
                                                    | = #{upper.determinants.FM}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') m
                                                    | = #{upper.determinants.m}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FC
                                                    | = #{upper.determinants.FC}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') CF
                                                    | = #{upper.determinants.CF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') C
                                                    | = #{upper.determinants.C}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') Cn
                                                    | = #{upper.determinants.Cn}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FC'
                                                    | = #{upper.determinants.FCprime}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') C'F
                                                    | = #{upper.determinants.CprimeF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') C'
                                                    | = #{upper.determinants.Cprime}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FY
                                                    | = #{upper.determinants.FY}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') YF
                                                    | = #{upper.determinants.YF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') Y
                                                    | = #{upper.determinants.Y}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FT
                                                    | = #{upper.determinants.FT}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') TF
                                                    | = #{upper.determinants.TF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') T
                                                    | = #{upper.determinants.T}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FV
                                                    | = #{upper.determinants.FV}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') VF
                                                    | = #{upper.determinants.VF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') V
                                                    | = #{upper.determinants.V}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') FD
                                                    | = #{upper.determinants.FD}
                                                    br
                                                    br
                                                    span(style='display: inline-block; width: 15px;') Fr
                                                    | = #{upper.determinants.Fr}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') rF
                                                    | = #{upper.determinants.rF}
                                                    br
                                                    span(style='display: inline-block; width: 15px;') (2)
                                                    | = #{upper.determinants.two}
                                                    br
                                                    br
                                                    br
                                                    br
                                                    br
                                                    //- br
                                                    //- | P = #{upper.determinants.P}
                        .col-md-2.col-2-print(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt;" colspan="3") 반응내용
                                            br
                                            | (Contents)
                                tbody
                                    tr
                                        td(style="font-size: 7pt;" colspan="3")
                                            div(style="margin-left: 0px;")
                                                - var order = ['H', '(H)', 'Hd', '(Hd)', 'Hx', 'A', '(A)', 'Ad', '(Ad)', 'An', 'Xy', 'Bl', 'Sx', 'Sc', 'Art', 'Ay', 'Hh', 'Fd', 'Cg', 'Na', 'Bt', 'Ls', 'Ge', 'Cl', 'Fi', 'Ex', 'Id', 'P']
                                                each key in order
                                                    span(style='display: inline-block; width: 23px;') #{key}
                                                    | = #{upper.contents[key]}
                                                    br
                                                    if key == 'Hx' || key=='(Ad)' || key == 'Sx' || key == 'Cg' || key == 'Ex'
                                                        br
                                            br
                                    
                        .col-md-4.col-3-print(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="3") 접근방식
                                            br
                                            | (Summary of Approach)
                                tbody
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") 카드
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="3") 위치와 발달질
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅰ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")= upper.approach[1].slice(0, 6).join(', ')
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅱ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")= upper.approach[2].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅲ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[3].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅳ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[4].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅴ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[5].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅵ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[6].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅶ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[7].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅷ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[8].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅸ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[9].slice(0, 6).join(', ')
                                            
                                    tr
                                        td.text-center(style="font-size: 7pt; padding: 2px;" colspan="1") Ⅹ
                                        td(style="font-size: 7pt; padding: 2px;" colspan="3")=upper.approach[10].slice(0, 6).join(', ')
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="24") 특수점수
                                            br
                                            | (Special Scores)
                                tbody(style="font-size: 7pt")
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                        td.text-center(style="padding: 2px;" colspan="9") LV1
                                        td.text-center(style="padding: 2px;" colspan="9") LV2
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') DV
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DV1} × 1 (#{upper.special_scores.DV1*1})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DV2} × 2 (#{upper.special_scores.DV2*2})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') INCOM
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.INCOM1} × 2 (#{upper.special_scores.INCOM1*2})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.INCOM2} × 4 (#{upper.special_scores.INCOM2*4})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') DR
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DR1} × 3 (#{upper.special_scores.DR1*3})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.DR2} × 6 (#{upper.special_scores.DR2*6})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') FABCOM
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.FABCOM1} × 4 (#{upper.special_scores.FABCOM1*4})
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.FABCOM2} × 7 (#{upper.special_scores.FABCOM2*7})
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') ALOG
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.ALOG} × 5 (#{upper.special_scores.ALOG*5})
                                        td.text-center(style="padding: 2px;" colspan="9")
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="6")
                                            span(style='display: inline-block; width: 50px;') CONTAM
                                            | =
                                        td.text-center(style="padding: 2px;" colspan="9") #{upper.special_scores.CONTAM} × 7 (#{upper.special_scores.CONTAM*7})
                                        td.text-center(style="padding: 2px;" colspan="9")
                                thead(style="font-size: 7pt")
                                    tr
                                        th.td-small.text-center(style="padding-top: 5px !important;" colspan="24") Sum6 = #{upper.special_scores.Sum6} &nbsp;&nbsp; WSum6 = #{upper.special_scores.WSum6}
                                tbody(style="font-size: 7pt")
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12")
                                            span(style='display: inline-block; width: 25px;') AG
                                            | = #{upper.special_scores.AG}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') AB
                                            | = #{upper.special_scores.AB}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') COP
                                            | = #{upper.special_scores.COP}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') CP
                                            | = #{upper.special_scores.CP}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') GHR
                                            | = #{upper.special_scores.GHR}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') MOR
                                            | = #{upper.special_scores.MOR}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') PHR
                                            | = #{upper.special_scores.PHR}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') PSV
                                            | = #{upper.special_scores.PSV}
                                    tr
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            span(style='display: inline-block; width: 25px;') PER
                                            | = #{upper.special_scores.PER}
                                        td.text-center(style="padding: 2px;" colspan="12") 
                                            
                    .row
                        .col-md-5(style="padding-right: 0px; padding-left: 0px; margin-top: -148px; margin-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.td-small.text-center(style="font-size: 7pt" colspan="4") 형태질
                                            br
                                            | (Form Quality)
                                tbody(style="font-size: 7pt")
                                    tr
                                        td.text-center(style="padding: 2px;")
                                        td.text-center(style="padding: 2px;") FQx
                                        td.text-center(style="padding: 2px;") MQuality
                                        td.text-center(style="padding: 2px;") W+D
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') +
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['+']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['+']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['+']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') o
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['o']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['o']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['o']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') u
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['u']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['u']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['u']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') -
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['-']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['-']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['-']}
                                    tr
                                        td.text-center(style="padding: 2px;")
                                            span(style='display: inline-block; width: 30px;') none
                                            | =
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.FQx['none']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.MQuality['none']}
                                        td.text-center(style="padding: 2px;") #{upper.form_quality.WPlusD['none']}
                        

                    .row
                        .col-md-12(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style='margin-bottom: 0;')
                                thead
                                    tr
                                        th.text-center 비율(RAIOS), 백분율(PERCENTAGES), 산출한 점수(DERIVATIONS)
                    
                    .row.display-flex
                        .col-md-5(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered.h-100(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 핵심 영역
                                            br
                                            | (CORE)
                                tbody
                                    tr
                                        td(colspan="8" )
                                            span(style='display: inline-block; width: 15px;') R
                                            | = #{lower.core.R}
                                        td(colspan="8") 
                                            | Lambda(L) = #{lower.core.Lambda}
                                        td(colspan='4')
                                            if lower.core.LambdaHighOrLow == 'High'
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | High
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | High
                                            br
                                            if lower.core.LambdaHighOrLow == 'Low'
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | Low
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | Low
                                    tr
                                        td(colspan="8")
                                            span(style='display: inline-block; width: 15px;') EB
                                            //-| = #{lower.core.EBLeft}:#{(lower.core.EBRight).toFixed(1)}
                                            | = #{lower.core.EBLeft}:#{roundTo(lower.core.EBRight, 1)}
                                            br
                                            span(style='display: inline-block; width: 15px;') eb
                                            | = #{lower.core.ebLeft}:#{lower.core.ebRight}
                                        td(colspan="8") 
                                            span(style='display: inline-block; width: 35px;') EA
                                            | = #{roundTo(lower.core.EA, 1)}
                                            br
                                            span(style='display: inline-block; width: 35px;') es
                                            | = #{lower.core.es}
                                            br
                                            span(style='display: inline-block; width: 35px;') Adj es
                                            | = #{lower.core.Adjes}
                                        td(colspan="8") 
                                            span(style='display: inline-block; width: 35px;') EBPer
                                            | = #{lower.core.EBPer}
                                            br
                                            span(style='display: inline-block; width: 35px;') D
                                            | = #{lower.core.D}
                                            br
                                            span(style='display: inline-block; width: 35px;') Adj D
                                            | = #{lower.core.AdjD}
                                    tr
                                        td(colspan="8") 
                                            span(style='display: inline-block; width: 15px;') FM
                                            | = #{lower.core.FM}
                                            br
                                            span(style='display: inline-block; width: 15px;') m
                                            | = #{lower.core.m}
                                        td(colspan="8")
                                            span(style='display: inline-block; width: 35px;') Sum C'
                                            | = #{lower.core.SumCprime}
                                            br
                                            span(style='display: inline-block; width: 35px;') Sum V
                                            | = #{lower.core.SumV}
                                        td(colspan="8")
                                            span(style='display: inline-block; width: 35px;') Sum T
                                            | = #{lower.core.SumT}
                                            br
                                            span(style='display: inline-block; width: 35px;') Sum Y
                                            | = #{lower.core.SumY}
                        
                        .col-md-3(style="padding-right: 2px; padding-left: 2px; width: 29.16%")
                            table.table.table-bordered.h-100(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 정서 영역
                                            br
                                            | (AFFECT)
                                tbody
                                    tr
                                        td(colspan="20", style='padding-right: 0; padding-left: 4px')
                                            span(style='display: inline-block; width: 100px;') FC : CF+C
                                            | = #{lower.affection.FCCFCLeft} : #{lower.affection.FCCFCRight}
                                            br
                                            span(style='display: inline-block; width: 100px;') Pure C
                                            | = #{lower.affection.PureC}
                                            br
                                            span(style='display: inline-block; width: 100px;') SumC' : WSumC
                                            //-| = #{lower.affection.SumCprime} : #{lower.affection.WSumC.toFixed(1)}
                                            | = #{lower.affection.SumCprime} : #{roundTo(lower.affection.WSumC, 1)}
                                            br
                                            span(style='display: inline-block; width: 100px;') Affective Ratio (Afr)
                                            | = #{lower.affection.Afr}
                                            br
                                            span(style='display: inline-block; width: 100px;') S
                                            | = #{lower.affection.S}
                                            br
                                            span(style='display: inline-block; width: 100px;') Blends : R
                                            //-| = #{lower.affection.Blends} : #{lower.affection.R} (#{(lower.affection.Blends * 100 / lower.affection.R).toFixed(0)}%)
                                            | = #{lower.affection.Blends} : #{lower.affection.R} (#{roundTo(lower.affection.Blends * 100 / lower.affection.R, 0)}%)
                                            br
                                            span(style='display: inline-block; width: 100px;') Color Projection (CP)
                                            | = #{lower.affection.CP}

                        .col-md-4(style="padding-right: 2px; padding-left: 2px; width: 29.16%")
                            table.table.table-bordered.h-100(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 대인 지각 영역
                                            br
                                            | (INTERPERSONAL PERCEPTION)
                                tbody
                                    tr
                                        td(colspan="12")
                                            span(style='display: inline-block; width: 100px;') COP
                                            | = #{lower.interpersonal.COP}
                                            br
                                            span(style='display: inline-block; width: 100px;') AG
                                            | = #{lower.interpersonal.AG}
                                            br
                                            span(style='display: inline-block; width: 100px;') GHR : PHR
                                            | = #{lower.interpersonal.GHR} : #{lower.interpersonal.PHR}
                                            br
                                            span(style='display: inline-block; width: 100px;') active : passive (a:p)
                                            | = #{lower.interpersonal.a} : #{lower.interpersonal.p}
                                            br
                                            span(style='display: inline-block; width: 100px;') Food (Fd)
                                            | = #{lower.interpersonal.Food}
                                            br
                                            span(style='display: inline-block; width: 100px;') SumT
                                            | = #{lower.interpersonal.SumT}
                                            br
                                            span(style='display: inline-block; width: 100px;') Human Contents
                                            | = #{lower.interpersonal.HumanCont}
                                            br
                                            span(style='display: inline-block; width: 100px;') Pure H
                                            | = #{lower.interpersonal.PureH}
                                            br
                                            span(style='display: inline-block; width: 100px;') PER
                                            | = #{lower.interpersonal.PER}
                                            br
                                            span(style='display: inline-block; width: 100px;') Isolation Index
                                            | = #{lower.interpersonal.ISOIndex}
                    .row.display-flex
                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 관념화 영역
                                            br
                                            | (IDEATION)
                                tbody
                                    tr
                                        td(colspan="16")
                                            span(style='display: inline-block; width: 100px;') active : passive (a:p)
                                            | = #{lower.ideation.a} : #{lower.ideation.p}
                                            br
                                            span(style='display: inline-block; width: 100px;') M<sup>a</sup> : M<sup>p</sup>
                                            | = #{lower.ideation.Ma} : #{lower.ideation.Mp}
                                            br
                                            span(style='display: inline-block; width: 100px;') Intellectual Index
                                            | = #{lower.ideation.twoABplusArtplusAy}
                                            br
                                            span(style='display: inline-block; width: 100px;') MOR
                                            | = #{lower.ideation.MOR}
                                            br
                                            span(style='display: inline-block; width: 100px;') Sum6
                                            | = #{lower.ideation.Sum6}
                                            br
                                            span(style='display: inline-block; width: 100px;') Lv2 Special Scores
                                            | = #{lower.ideation.Lv2}
                                            br
                                            span(style='display: inline-block; width: 100px;') WSum6
                                            | = #{lower.ideation.WSum6}
                                            br
                                            span(style='display: inline-block; width: 100px;') M-
                                            | = #{lower.ideation.Mminus}
                                            br
                                            span(style='display: inline-block; width: 100px;') M none
                                            | = #{lower.ideation.Mnone}


                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 인지적 중재 영역
                                            br
                                            | (COGNITIVE MEDIATION)
                                tbody
                                    tr
                                        td(colspan="12") 
                                            span(style='display: inline-block; width: 70px;') XA%
                                            | = #{lower.cognitive_mediation.XAper}
                                            br
                                            span(style='display: inline-block; width: 70px;') XDA%
                                            | = #{lower.cognitive_mediation.WDAper}
                                            br
                                            span(style='display: inline-block; width: 70px;') X-%
                                            //-| = #{lower.cognitive_mediation.Xminusper.toFixed(2)}
                                            | = #{roundTo(lower.cognitive_mediation.Xminusper, 2)}
                                            br
                                            span(style='display: inline-block; width: 70px;') S-
                                            | = #{lower.cognitive_mediation.Sminus}
                                            br
                                            span(style='display: inline-block; width: 70px;') Popular (P)
                                            | = #{lower.cognitive_mediation.P}
                                            br
                                            span(style='display: inline-block; width: 70px;') X+%
                                            | = #{lower.cognitive_mediation.Xplusper}
                                            br
                                            span(style='display: inline-block; width: 70px;') Xu%
                                            | = #{lower.cognitive_mediation.Xuper}


                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24", style='padding-left: 0; padding-right: 0;') 정보 처리 영역
                                            br
                                            | (INFORMATION PROCESSING)
                                tbody
                                    tr
                                        td(colspan="12")
                                            span(style='display: inline-block; width: 60px;') Zf
                                            | = #{lower.information_processing.Zf}
                                            br
                                            span(style='display: inline-block; width: 60px;') W : D : Dd
                                            | = #{lower.information_processing.W} : #{lower.information_processing.D} : #{lower.information_processing.Dd}
                                            br
                                            span(style='display: inline-block; width: 60px;') W : M
                                            | = #{lower.information_processing.W} : #{lower.information_processing.M}
                                            br
                                            span(style='display: inline-block; width: 60px;') Zd
                                            | = 
                                            + parseSign(lower.information_processing.Zd)
                                            br
                                            span(style='display: inline-block; width: 60px;') PSV
                                            | = #{lower.information_processing.PSV}
                                            br
                                            span(style='display: inline-block; width: 60px;') DQ+
                                            | = #{lower.information_processing.DQplus}
                                            br
                                            span(style='display: inline-block; width: 60px;') DQv
                                            | = #{lower.information_processing.DQv}


                        .col-md-3(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%;")
                                thead
                                    tr
                                        th.td-small.text-center(colspan="24") 자기 지각 영역
                                            br
                                            | (SELF-PERCEPTION)
                                tbody
                                    tr
                                        td(colspan="12")
                                            span(style='display: inline-block; width: 90px;') Egocentricity Index
                                            | = #{lower.self_perception.EgocentricityIndex}
                                            br
                                            span(style='display: inline-block; width: 90px;') Reflections (Fr+rf)
                                            | = #{lower.self_perception.Reflections}
                                            br
                                            span(style='display: inline-block; width: 90px;') SumV
                                            | = #{lower.self_perception.SumV}
                                            br
                                            span(style='display: inline-block; width: 90px;') FD
                                            | = #{lower.self_perception.FD}
                                            br
                                            span(style='display: inline-block; width: 90px;') An+Xy
                                            | = #{lower.self_perception.AnPlusXy}
                                            br
                                            span(style='display: inline-block; width: 90px;') MOR
                                            | = #{lower.self_perception.MOR}
                                            br
                                            span(style='display: inline-block; width: 90px;') H : (H)+Hd+(Hd)
                                            | = #{lower.self_perception.H} : #{lower.self_perception.Hrest}

                    .row
                        .col-md-12(style="padding-right: 2px; padding-left: 2px;")
                            table.table.table-bordered(style="font-size: 7pt;")
                                thead
                                    tr
                                        th.text-center(colspan="4")
                                            if lower.special_indices.SCONPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | S-CON = YES(#{lower.special_indices.SCON})
                                            else
                                                if lower.special_indices.SCON == -1
                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                    | S-CON = N/A
                                                else
                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                    | S-CON = NO(#{lower.special_indices.SCON})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.PTI>=4
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | PTI = YES(#{lower.special_indices.PTI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | PTI = NO(#{lower.special_indices.PTI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.DEPIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | DEPI = YES(#{lower.special_indices.DEPI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | DEPI = NO(#{lower.special_indices.DEPI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.CDIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | CDI = YES(#{lower.special_indices.CDI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | CDI = NO(#{lower.special_indices.CDI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.HVIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | HVI = YES
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | HVI = NO
                                        th.text-center(colspan="4")
                                            if lower.special_indices.OBSPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | OBS = YES
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | OBS = NO


            .page
                .subpage#page3
                    .row
                        .col-md-12.text-center
                            h3 특수지표 (Constellation Worksheet)

                    .row
                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 360px;")
                            table.table.table-bordered(style="font-size: 7pt; margin-bottom: 0; height: 100%;")
                                thead
                                    tr
                                        th.text-center S-Constellation (Suicide Potential) : 만 14세 이상만 적용
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight:bold;")
                                                if SpecialIndices.S_Constellation.Up8Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if 8 or more conditions are true
                                            
                                            p
                                                if SpecialIndices.S_Constellation.SumVplusFD
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;SumV + FD > 2
                                            p
                                                if SpecialIndices.S_Constellation.ColorShadingBlends
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Color-Shading Blends > 0
                                            p
                                                if SpecialIndices.S_Constellation.Ego
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Egocentricity Index < 0.31 or Egocentricity Index > 0.44
                                            p
                                                if SpecialIndices.S_Constellation.MOR
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;MOR > 3
                                            p
                                                if SpecialIndices.S_Constellation.Zd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Zd > +3.5) or (Zd < -3.5)
                                            p
                                                if SpecialIndices.S_Constellation.es
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;es > EA
                                            p
                                                if SpecialIndices.S_Constellation.CF
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;CF + C > FC
                                            p
                                                if SpecialIndices.S_Constellation.XPlus
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;X+% < 0.70
                                            p
                                                if SpecialIndices.S_Constellation.S
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;S > 3
                                            p
                                                if SpecialIndices.S_Constellation.P
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Populars(P) < 3) or (Populars(P) > 8)
                                            p
                                                if SpecialIndices.S_Constellation.PureH
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Pure H < 2
                                            p
                                                if SpecialIndices.S_Constellation.R
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;R < 17

                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 360px;")
                            table.table.table-bordered(style="font-size: 7pt; margin-bottom: 0; height: 100%;")
                                thead
                                    tr
                                        th.text-center PTI (Perceptual Thinking Index)
                                        - var PTITotal = 0
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p
                                                if SpecialIndices.PTI.XAper
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(XA% < 0.70) and (WDA% < 0.75)
                                            p
                                                if SpecialIndices.PTI.Xminusper
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;X-% > 0.29
                                            p
                                                if SpecialIndices.PTI.Level2
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Sum Level2 Special Score > 2) and (FABCOM Level2 > 0)
                                            p
                                                span(style='margin-left: -6px;') *
                                                if SpecialIndices.PTI.R
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age >= 5 && testconfig.age <= 7
                                                    | &nbsp;{(R < 17) and (WSum6 > 16)} or {(R > 16) and (WSum6 > 20)}
                                                else if testconfig.age >= 8 && testconfig.age <= 10
                                                    | &nbsp;{(R < 17) and (WSum6 > 15)} or {(R > 16) and (WSum6 > 19)}
                                                else if testconfig.age >= 11 && testconfig.age <= 13
                                                    | &nbsp;{(R < 17) and (WSum6 > 14)} or {(R > 16) and (WSum6 > 18)}
                                                else
                                                    | &nbsp;{(R < 17) and (WSum6 > 12)} or {(R > 16) and (WSum6 > 17)}
                                            p
                                                if SpecialIndices.PTI.M
                                                    i.fa.fa-check-square-o
                                                    - PTITotal += 1;
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(M- > 1) or (X-% > 0.40)
                                            P(style="font-weight: bold;")="Total = " + PTITotal.toString()

                    
                    .row
                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 250px;")
                            table.table.table-bordered(style="font-size: 7pt;height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center DEPI (Depression Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.DEPI.Up5Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if 5 or more conditions are true
                                            p
                                                if SpecialIndices.DEPI.FV
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(SumV > 0) or (FD > 2)
                                            p
                                                if SpecialIndices.DEPI.ColorShadingBlends
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Color-Shading Blends > 0) or (S > 2)
                                            p
                                                span(style='margin-left: -6px;') *
                                                if SpecialIndices.DEPI.Ego
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age == 5
                                                    | &nbsp;(Egocentricity Index > 0.83 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.55)
                                                else if testconfig.age == 6
                                                    | &nbsp;(Egocentricity Index > 0.82 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.52)
                                                else if testconfig.age == 7
                                                    | &nbsp;(Egocentricity Index > 0.77 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.52)
                                                else if testconfig.age == 8
                                                    | &nbsp;(Egocentricity Index > 0.74 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.48)
                                                else if testconfig.age == 9
                                                    | &nbsp;(Egocentricity Index > 0.69 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.45)
                                                else if testconfig.age == 10
                                                    | &nbsp;(Egocentricity Index > 0.63 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.45)
                                                else if testconfig.age == 11
                                                    | &nbsp;(Egocentricity Index > 0.58 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.45)
                                                else if testconfig.age == 12
                                                    | &nbsp;(Egocentricity Index > 0.58 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.38)
                                                else if testconfig.age == 13
                                                    | &nbsp;(Egocentricity Index > 0.56 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.38)
                                                else if testconfig.age == 14
                                                    | &nbsp;(Egocentricity Index > 0.54 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.37)
                                                else if testconfig.age == 15
                                                    | &nbsp;(Egocentricity Index > 0.50 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.33)
                                                else if testconfig.age == 16
                                                    | &nbsp;(Egocentricity Index > 0.48 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.33)
                                                else
                                                    | &nbsp;(Egocentricity Index > 0.44 and Reflection(Fr+rF) = 0) or (Egocentricity Index < 0.33)
                                            p
                                                span(style='margin-left: -6px;') *
                                                if SpecialIndices.DEPI.Afr
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age >= 5 && testconfig.age <= 6
                                                    | &nbsp;(Affective Ratio(Afr) < 0.57) or (Blends < 4)
                                                else if testconfig.age >= 7 && testconfig.age <= 9
                                                    | &nbsp;(Affective Ratio(Afr) < 0.55) or (Blends < 4)
                                                else if testconfig.age >= 10 && testconfig.age <= 13
                                                    | &nbsp;(Affective Ratio(Afr) < 0.53) or (Blends < 4)
                                                else
                                                    | &nbsp;(Affective Ratio(Afr) < 0.46) or (Blends < 4)
                                            p
                                                if SpecialIndices.DEPI.SumShading
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(SumShading > FM + m) or (SumC' > 2)
                                            p
                                                if SpecialIndices.DEPI.MOR
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(MOR > 2) or (Intellectualization Index > 3)
                                            p
                                                if SpecialIndices.DEPI.COP
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(COP < 2) or (Isolation Index > 0.24)

                        .col-md-6(style="padding-right: 2px; padding-left: 2px;height: 250px;")
                            table.table.table-bordered(style="font-size: 7pt;height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center CDI (Coping Deficit Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.CDI.Up4Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if 4 or more conditions are true
                                            p
                                                if SpecialIndices.CDI.EA
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(EA < 6) or (Adj D < 0)
                                            p
                                                if SpecialIndices.CDI.COP
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(COP < 2) and (AG < 2)
                                            p
                                                if SpecialIndices.CDI.WSumC
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                if testconfig.age >= 5 && testconfig.age <= 6
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.57)
                                                else if testconfig.age >= 7 && testconfig.age <= 9
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.55)
                                                else if testconfig.age >= 10 && testconfig.age <= 13
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.53)
                                                else
                                                    | &nbsp;(WSumC < 2.5) or *(Affective Ratio(Afr) < 0.46)
                                            p
                                                if SpecialIndices.CDI.Passive
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Passive(p) > Active(a)+1) or (Pure H < 2)
                                            p
                                                if SpecialIndices.CDI.SumT
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(Sum T > 1) or (Isloation Index > 0.24) or (Food > 0)
                                            p
                                                br
                                                br
                                                br
                    .row
                        .col-md-6(style="padding-right: 2px; padding-left: 2px; height: 320px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center HVI (Hypervigilance Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.HVI.Up4Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if (1) is true and at least 4 of the others are true
                                            p
                                                if SpecialIndices.HVI.FT
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;<u>(1) SumT = 0</u>
                                            p
                                                if SpecialIndices.HVI.Zf
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(2) Zf > 12
                                            p
                                                if SpecialIndices.HVI.Zd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(3) Zd > +3.5
                                            p
                                                if SpecialIndices.HVI.S
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(4) S > 3
                                            p
                                                if SpecialIndices.HVI.H
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(5) Human Content > 6
                                            p
                                                if SpecialIndices.HVI.ParH
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(6) (H) + (A) + (Hd) + (Ad) > 3
                                            p
                                                if SpecialIndices.HVI.HplusA
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(7) H + A : Hd + Ad < 4 : 1
                                            p
                                                if SpecialIndices.HVI.Cg
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(8) Cg > 3
                                            
                        .col-md-6(style="padding-right: 2px; padding-left: 2px; height: 320px;")
                            table.table.table-bordered(style="font-size: 7pt; height: 100%; margin-bottom: 0;")
                                thead
                                    tr
                                        th.text-center OBS (Obsessive Style Index)
                                tbody(style="text-indent: 5px;")
                                    tr
                                        td
                                            p
                                                if SpecialIndices.OBS.Dd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(1) Dd > 3
                                            p
                                                if SpecialIndices.OBS.Zf
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(2) Zf > 12
                                            p
                                                if SpecialIndices.OBS.Zd
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(3) Zd > +3.0
                                            p
                                                if SpecialIndices.OBS.Populars
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(4) Populars(P) > 7
                                            p
                                                if SpecialIndices.OBS.FQplus
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(5) FQx+ > 1
                                    tr
                                        td
                                            p(style="font-weight: bold;")
                                                if SpecialIndices.OBS.Up1Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Positive if one or more is true
                                            p
                                                if SpecialIndices.OBS.AllChecked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;Conditions (1) to (5) are all true
                                            p
                                                if SpecialIndices.OBS.Up2Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;2 or more of (1) to (4) are true and (FQx+ > 3)
                                            p
                                                if SpecialIndices.OBS.Up3Checked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;3 or more of (1) to (5) are true and (X+% > 0.89)
                                            p
                                                if SpecialIndices.OBS.FQplusChecked
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;(FQx+ > 3) and (X+% > 0.89)



        
            .wide-page(style='margin-top: 0;')
                .wide-subpage
                    .row
                        .col-md-12.text-center
                            h3(style="font-size: 16pt;") 로르샤하 검사 해석 보고서
                            h3 The Rorschach Test Interpretation Report
                    .row
                        .col-md-12
                            table.table.table-bordered(style="font-size: 10pt;")
                                thead
                                    tr
                                        th.text-center(colspan="24") RIAS Ⅱ 자동해석 보고서
                                tbody
                                    tr
                                        td.text-center(style='min-width: 60px;') 이 름
                                        td.text-center(style='min-width: 140px;') #{testconfig.name}
                                        td.text-center(style='min-width: 30px') 성 별
                                        td.text-center(style='min-width: 100px') #{testconfig.sex}
                                        td.text-center(style='min-width: 70px;') 채점 번호
                                        td.text-center(style='min-width: 57px;')
                                    tr
                                        td.text-center 생년월일
                                        td.text-center #{moment(testconfig.birthday).format('YYYY년 MM월 DD일')}
                                        td.text-center 나 이
                                        td.text-center 만 #{age}세
                                        td.text-center 직 업
                                        td.text-center #{testconfig.job}
                                    tr
                                        td.text-center 검사일자
                                        td.text-center #{moment(testconfig.testdate).format('YYYY년 MM월 DD일')}
                                        td.text-center 학 력
                                        td.text-center #{testconfig.graduate}
                                        td.text-center 진 단
                                        td.text-center #{testconfig.diagnosis}
                                    tr
                                        td.text-center 검사기관
                                        td(colspan='5').text-center
                                            = testconfig.comName_input 
                                            | (검사자: 
                                            = testconfig.inspector
                                            | )
                    .row
                        .col-md-12
                            h4.text-danger 1. 로르샤하 검사의 타당성 검증
                        //-
                            p.a(style="font-size: 9pt;") 수검태도에서 각 카드에 대해 ‘아무것도 전혀 볼 수 없다(반응거부)’고 호소하지 않고 각 카드에서 1개 이상의 반응을 모두 보였다면 아래 조건에 따라 타당한 것으로 볼 수 있습니다. 전체 반응수(R)에서 볼 때 <span style="color: #007bff; font-weight: bold;">(#{step0.R.validate})</span>에 해당하고 있으며, 형태질에서 순수형태의 반응비율(Lambda(L))에서 볼 때 <span style="color: #007bff; font-weight: bold;">(#{step0.L.validate})</span>에 해당하는 수준의 수행을 보이고 있다. 타당하지 않는 것으로 나타날 경우에는 극단 값에 해당하는 지표를 기준으로 해석해야 하고 타당하지 않은 이유에 대해 질적 분석을 해야 하며 해석의 타당성은 제한적입니다.

                    .row
                        .col-md-12
                            table.table.table-bordered(style="font-size: 8pt;")
                                thead
                                    tr
                                        th.text-center(colspan="1") 전체 반응 수 (R = <span class="text-danger">#{step0.R.R}</span>)
                                        th.text-center(colspan="1") Lambda (L = <span class="text-danger">#{step0.L.L}</span>)
                                tbody
                                    tr
                                        td(colspan="1")
                                            p(style="font-weight: bold;")
                                                if step0.R.validate=='타당함'
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;타당함: 조건 (1) 또는 (2)에 해당할 경우
                                            p(style="font-weight: bold;")
                                                if step0.R.validate=='타당도 낮음'
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;타당성 낮음: 조건 (3)에 해당할 경우
                                            p(style="font-weight: bold;")
                                                if step0.R.validate=='타당도 없음'
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;타당성 없음: 조건 (4)에 해당할 경우
                                            p
                                                if step0.R.check1
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp; (1) 16 < R < 28
                                                br
                                                if step0.R.check2
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp; (2) 27 < R
                                                br
                                                if step0.R.check3
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp; (3) Short R : 13 < R < 17
                                                br
                                                if step0.R.check4
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp; (4) Brief R : R < 14
                                        td(colspan="1")
                                            p(style="font-weight: bold;")
                                                if step0.L.validate=='타당함'
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;타당함: 조건 (1)에 해당할 경우
                                            p(style="font-weight: bold;")
                                                if step0.L.validate=='타당하지 않음'
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp;타당성 낮음: 조건 (2)또는 (3)에 해당할 경우
                                            p
                                                if step0.L.check1
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp; (1) 0.30 ≤ Lambda(L) ≤ 0.99
                                                br
                                                if step0.L.check2
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp; (2) High Lambda (L): 0.99 < Lambda (L)
                                                br
                                                if step0.L.check3
                                                    i.fa.fa-check-square-o
                                                else
                                                    i.fa.fa-square-o
                                                | &nbsp; (3) Low Lambda (L): 0.30 > Lambda (L)

                    .row
                        .col-md-12
                            table.table.table-bordered(style="font-size: 7pt;")
                                tbody
                                    tr
                                        td
                                            h5 &#x27B2; 수검자가 방어적이거나, 경험유형(EB style)이 회피 유형이거나, 반응을 왜곡하려고 시도했거나, 신경학적 기능 이상이 있는 것으로 의심된다면 다른 정보를 통해 검사 결과의 타당성을 확인하세요.
                                        //-
                                            h5 아래 조건에 해당하는 것으로 의심될 경우 다른 정보를 통해 타당성을 다시 평가하시기 바랍니다.
                                            p 1. 방어적인 수검자
                                                br
                                                | 2. 회피 유형의 수검자
                                                br
                                                | 3. 반응을 왜곡하려는 수검자
                                                br
                                                | 4. 신경학적 기능 이상이 있는 수검자
                    .row
                        .col-md-12
                            h4.text-danger 2. 로르샤하 검사 결과의 군집별 해석 전략의 선택

                    .row
                        .col-md-12
                            table.table.table-bordered(style="font-size: 7pt;")
                                thead
                                    tr
                                        th.text-center(colspan="6") 대처 방식 유형
                                        th.text-center(colspan="6") 내향형 (Introversive)
                                        th.text-center(colspan="6") 외향형 (Extratensive)
                                        th.text-center(colspan="6") 양향형 (Ambitent)
                                tbody
                                    tr
                                        td.text-center(colspan="6") Average Lambda(L)
                                        if experienceClassification.copyingStyle=="Introversive" && experienceClassification.approachStyle=="True"
                                            td.text-center.bg-warning(colspan="6") True Introversive
                                        else
                                            td.text-center(colspan="6") True Introversive
                                        if experienceClassification.copyingStyle=="Extratensive" && experienceClassification.approachStyle=="True"
                                            td.text-center.bg-warning(colspan="6") True Extratensive
                                        else
                                            td.text-center(colspan="6") True Extratensive
                                        if experienceClassification.copyingStyle=="Ambitent" && experienceClassification.approachStyle=="True"
                                            td.text-center.bg-warning(colspan="6") True Ambitent
                                        else
                                            td.text-center(colspan="6") True Ambitent
                                    tr
                                        td.text-center(colspan="6") 지배적 대처 방식
                                        if experienceClassification.copyingStyle=="Introversive" && experienceClassification.dominantStyle=="Flexible"
                                            td.text-center.bg-warning(colspan="3") Flexible Introversive
                                        else
                                            td.text-center(colspan="3") Flexible Introversive
                                        if experienceClassification.copyingStyle=="Introversive" && experienceClassification.dominantStyle=="Pervasive"
                                            td.text-center.bg-warning(colspan="3") Pervasive Introversive
                                        else
                                            td.text-center(colspan="3") Pervasive Introversive
                                        if experienceClassification.copyingStyle=="Extratensive" && experienceClassification.dominantStyle=="Flexible"
                                            td.text-center.bg-warning(colspan="3") Flexible Extratensive
                                        else
                                            td.text-center(colspan="3") Flexible Extratensive
                                        if experienceClassification.copyingStyle=="Extratensive" && experienceClassification.dominantStyle=="Pervasive"
                                            td.text-center.bg-warning(colspan="3") Pervasive Extratensive
                                        else
                                            td.text-center(colspan="3") Pervasive Extratensive
                                        td.text-center(colspan="6")
                                    tr
                                        td.text-center(colspan="6") High Lambda(L)
                                        if experienceClassification.approachStyle=="Avoidant" && experienceClassification.copyingStyle=="Introversive"
                                            td.text-center.bg-warning(colspan="6") Avoidant Introversive
                                        else
                                            td.text-center(colspan="6") Avoidant Introversive
                                        if experienceClassification.approachStyle=="Avoidant" && experienceClassification.copyingStyle=="Extratensive"
                                            td.text-center.bg-warning(colspan="6") Avoidant Extratensive
                                        else
                                            td.text-center(colspan="6") Avoidant Extratensive
                                        if experienceClassification.approachStyle=="Avoidant" && experienceClassification.copyingStyle=="Ambitent"
                                            td.text-center.bg-warning(colspan="6") Avoidant Ambitent
                                        else
                                            td.text-center(colspan="6") Avoidant Ambitent
                                    tr
                                        td.text-center(colspan='6') 경 험 유 형
                                        td.text-center(colspan='18')
                                            if experienceClassification.approachStyle == 'True'
                                                | 진성&nbsp;
                                                if experienceClassification.copyingStyle == 'Introversive'
                                                    | 내향형
                                                else if experienceClassification.copyingStyle == 'Extratensive'
                                                    | 외향형
                                                else if experienceClassification.copyingStyle == 'Ambitent'
                                                    | 양향형
                                                if experienceClassification.copyingStyle != 'Ambitent'
                                                    | &nbsp;&&nbsp;
                                                    if experienceClassification.dominantStyle == 'Flexible'
                                                        | 유연한
                                                    else
                                                        | 지배적
                                                    | &nbsp;
                                                    if experienceClassification.copyingStyle =='Introversive'
                                                        | 내향형
                                                    else if experienceClassification.copyingStyle == 'Extratensive'
                                                        | 외향형
                                                    else if experienceClassification.copyingStyle == 'Ambitent'
                                                        | 양향형
                                            else if experienceClassification.approachStyle == "Avoidant"
                                                | 회피
                                                if experienceClassification.copyingStyle =='Introversive'
                                                    | &nbsp;내향형
                                                else if experienceClassification.copyingStyle == 'Extratensive'
                                                    | &nbsp;외향형
                                                else if experienceClassification.copyingStyle == 'Ambitent'
                                                    | &nbsp;양향형
                                                else
                                                    | 형
                                            else
                                                | 해당사항없음


                    if experienceClassification.approachStyle == "" && experienceClassification.copyingStyle == "" && experienceClassification.dominantStyle == ""
                        .row
                            .col-md-12.text-center
                                h5.text-warning 이 수검자는 대처 방식 유형(EB Style)을 계산할 수 없습니다.
                    .row
                        .col-md-12
                            table.table.table-bordered(style="font-size: 7pt;")
                                thead
                                    tr
                                        th.text-center(colspan="4")
                                            if lower.special_indices.SCONPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | S-CON = YES(#{lower.special_indices.SCON})
                                            else
                                                if lower.special_indices.SCON == -1

                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                    | S-CON = N/A
                                                else
                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                    | S-CON = NO(#{lower.special_indices.SCON})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.PTI>=4
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | PTI = YES(#{lower.special_indices.PTI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | PTI = NO(#{lower.special_indices.PTI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.DEPIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | DEPI = YES(#{lower.special_indices.DEPI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | DEPI = NO(#{lower.special_indices.DEPI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.CDIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | CDI = YES(#{lower.special_indices.CDI})
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | CDI = NO(#{lower.special_indices.CDI})
                                        th.text-center(colspan="4")
                                            if lower.special_indices.HVIPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | HVI = YES
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | HVI = NO
                                        th.text-center(colspan="4")
                                            if lower.special_indices.OBSPositive == true
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | OBS = YES
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | OBS = NO
            
                    .row
                        .col-md-12
                            table.table.table-bordered.table-striped(style="font-size: 8pt;")
                                tbody
                                    tr
                                        td(colspan='2')
                                            | 핵심변인 : 
                                            each main, index in Order.main
                                                if index != 0
                                                    | , 
                                                if Order.mainChecked[index]
                                                    i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                else
                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | #{main}
                                            if Order.main.length == 0
                                                | 해당 사항 없음
                                    tr
                                        td
                                            | 제 3변인 : 
                                            each third, index in Order.thirdParty
                                                if index != 0
                                                    | ,
                                                if Order.thirdChecked[index]
                                                    i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                else
                                                    i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                                | #{third}
                                            if Order.thirdParty.length == 0
                                                | 해당 사항 없음
                                        td(width='15%') 
                                            if Order.randomCheck
                                                i.fa.fa-check-square-o(style="margin-right: 6px; font-size: 11pt;")
                                            else
                                                i.fa.fa-square-o(style="margin-right: 6px; font-size: 11pt;")
                                            | 임의 순서
                                    tr
                                        - Order.order = Order.order.map((order) =>{ return order == '통제력' ? '통제력(내적변인-상황변인)' : order })
                                        td(colspan='2', style="font-weight: bold;") 군집별 해석 순서 : #{Order.order.join(' > ')}


            each T in TESTRESULT
                if T.resultName == "Interpersonal Perception and Behavior 대인지각과 대인행동 평가"
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    img(src='/img/interpersonal_perception.jpg', style='max-width: 100%; height: 60px;')
                                    //-h3 대인 지각 영역 (Interpersonal Perception)
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 대인 지각 영역(Interpersonal Perception) 분석 단계
                                        tbody
                                            tr
                                                td
                                                    .row
                                                        .col-md-5
                                                            p
                                                                span Step 1: 
                                                                if lower.special_indices.CDIPositive == true
                                                                    i.fa.fa-check-square-o
                                                                else
                                                                    i.fa.fa-square-o
                                                                |  CDI = [ #{lower.special_indices.CDI} ]
                                                                br
                                                                span Step 2: 
                                                                if lower.special_indices.HVIPositive == true
                                                                    i.fa.fa-check-square-o
                                                                    |  HVI = [ Yes ]
                                                                else
                                                                    i.fa.fa-square-o
                                                                    |  HVI = [ No ]
                                                                br
                                                                span Step 3: active : passive (a:p) = [ #{lower.interpersonal.a} : #{lower.interpersonal.p} ]
                                                                br
                                                                sapn Step 4: Food(Fd) responses =  [ #{upper.contents.Fd} ]
                                                                br
                                                                span Step 5: Sum T =  [ #{lower.core.SumT} ]
                                                                br
                                                                span Step 6: Human Contents = [ #{lower.interpersonal.HumanCont} ] & Pure H = [ #{lower.interpersonal.PureH} ]
                                                                br
                                                                span Step 7: GHR : PHR = [ #{lower.interpersonal.GHR} : #{lower.interpersonal.PHR} ]
                                                        .col-md-7
                                                            p
                                                                span Step 8: COP frequencies = [ #{upper.special_scores.COP} ]
                                                                br
                                                                span(style='margin-left: 42px;') & AG frequencies = [ #{upper.special_scores.AG} ] & coding (질적 분석)
                                                                br
                                                                span Step 9: PER = [ #{upper.special_scores.PER} ]
                                                                br
                                                                span Step 10: Isolation Index = [ #{lower.interpersonal.ISOIndex} ]
                                                                br
                                                                span Step 11: Contents of M responses with pairs(2) = [ #{Mwith2} ] (질적 분석)
                                                                br
                                                                span(style='margin-left: 48px;') Contents of FM responses with pairs(2) = [ #{FMwith2} ] (질적 분석)
                                            tr
                                                td
                                                    ul
                                                        li
                                                            | 대인지각 중요변인: 소외지표(Isolation Index), 인간표상반응 (GHR : PHR)
                                                        li
                                                            | 대인지각 관련개념: 대인관계(Interpersonal Relationships: Social Cognition, Social Skill), 자기중심성(Self-Centeredness), 
                                                            .indent
                                                                | 관계적 자기(Relational Self), 의심과 방어(Suspiciousness & Defensiveness)
                            - var flag = true;
                            - var steps = T.steps.filter((step) => { return step.textData.length });
                            - steps1 = steps//.splice(0, 5);
                            each step in steps1
                                .row
                                    .col-md-12
                                        if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                            if flag
                                                | &#x27B2;
                                                - flag = false
                                        p(style="font-size: 11pt; line-height: 160%;")
                                            if step.textData.length == 0
                                            else
                                                span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                each text in step.textData
                                                    if !text.includes('[질적 분석]')
                                                        !=text
                            .row
                                .col-md-12(style="font-size: 11pt; line-height: 160%;")
                                    ul

                                        li
                                            | 질적 분석할 단계
                                            br
                                            | Step 8: COP frequencies = [ #{upper.special_scores.COP} ] & AG frequencies = [ #{upper.special_scores.AG} ] & coding
                                            br
                                            | Step 11: Contents of M responses with pairs(2) = [ #{Mwith2} ] & Contents of FM responses with pairs(2) = [ #{FMwith2} ]

                //-
                    if steps.length > 0
                        .wide-page
                            .wide-subpage
                                .row
                                    .col-md-12
                                        each step in steps
                                            if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                                if flag
                                                    | &#x27B2;
                                                    - flag = false
                                            p(style="font-size: 11pt; line-height: 160%;")
                                                span(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                if step.textData.length == 0
                                                else
                                                    each text in step.textData
                                                        if !text.includes('[질적 분석]')
                                                            !=text



                                .row
                                    .col-md-12(style="font-size: 9pt;")
                                        ul

                                            li
                                                | 질적 분석할 단계
                                                br
                                                | Step 8: COP frequencies = [ #{upper.special_scores.COP} ] & AG frequencies = [ #{upper.special_scores.AG} ] & coding
                                                br
                                                | Step 11: Contents of M responses with pairs(2) = [ #{Mwith2} ] & Contents of FM responses with pairs(2) = [ #{FMwith2} ]
                                //-
                                    table.table.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 질적 해석
                                        tbody
                                            tr
                                                td
                                                    p
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                if T.resultName == "Affect 정서 자원이 사용되는 방식, 정서 상태, 정서의 역기능 평가"
                    - var steps = T.steps;
                    - var stepLeft = steps;//.splice(0, 5);
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    //-h3 정서 영역 (Affect)
                                    img(src='/img/affect.jpg', style='max-width: 100%;height: 60px;')
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 정서 영역(Affect) 분석 단계
                                        tbody
                                            tr
                                                td
                                                    .row
                                                        .col-md-6
                                                            p
                                                                span Step 1: 
                                                                    if lower.special_indices.DEPIPositive == true
                                                                        i.fa.fa-check-square-o
                                                                        |  DEPI = [ #{lower.special_indices.DEPI} ] & 
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  DEPI = [ #{lower.special_indices.DEPI} ] & 
                                                                    
                                                                    if lower.special_indices.CDIPositive == true
                                                                        i.fa.fa-check-square-o
                                                                        |  CDI = [ #{lower.special_indices.CDI} ]
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  CDI = [ #{lower.special_indices.CDI} ]
                                                                br
                                                                //-span Step 2: EB = [ #{(lower.core.EBLeft).toFixed(0)} : #{(lower.core.EBRight).toFixed(1)} ] 
                                                                span Step 2: EB = [ #{roundTo(lower.core.EBLeft, 0)} : #{roundTo(lower.core.EBRight, 1)} ] 
                                                                br
                                                                span(style='margin-left: 42px;')
                                                                    | & Lambda(L) = [ #{lower.core.Lambda} ]
                                                                    | ( 
                                                                    if lower.core.Lambda > 0.99
                                                                        i.fa.fa-check-square-o
                                                                        |  High  
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  High  
                                                                    if lower.core.Lambda < 0.3
                                                                        i.fa.fa-check-square-o
                                                                        |  [Low]
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  [Low]
                                                                    |  )
                                                                br
                                                                if lower.core.EBPer == 'N/A'
                                                                    span Step 3: EBPer = [ N/A ]
                                                                else
                                                                    //-span Step 3: EBPer = [ #{parseFloat(lower.core.EBPer).toFixed(1)} ]
                                                                    span Step 3: EBPer = [ #{roundTo(parseFloat(lower.core.EBPer), 1)} ]
                                                                br
                                                                span Step 4: Right Side eb = [ #{lower.core.ebRight} ] & variables related to it
                                                                br
                                                                //-span Step 5: SumC' : WSumC = [ #{lower.core.SumCprime} : #{lower.affection.WSumC.toFixed(1)} ]
                                                                span Step 5: SumC' : WSumC = [ #{lower.core.SumCprime} : #{roundTo(lower.affection.WSumC, 1)} ]
                                                                br
                                                                span Step 6: Affective Ratio(Afr) = [ #{lower.affection.Afr} ]
                                                                br
                                                                span Step 7: Intellectualization Index = [ #{lower.ideation.twoABplusArtplusAy} ]
                                                                br
                                                                span Step 8: Color Projection(CP) = [ #{upper.special_scores.CP} ]
                                                                br
                                                                span Step 9: FC : CF + C = [ #{lower.affection.FCCFCLeft} : #{lower.affection.FCCFCRight} ]
                                                                br
                                                                span Step 10: Pure C = [ #{lower.affection.PureC} ] (질적 분석)
                                                        .col-md-6(style='margin-left: -10px; padding-left: 0; padding-right: 0;')
                                                            p
                                                                - var Scount = 0;
                                                                each score in scores
                                                                    if score.loc == 'WS' || score.loc == 'DS' || score.loc == 'DdS'
                                                                        - Scount += 1;
                                                                span Step 11: Space(S) responses = [ #{Scount} ]
                                                                br
                                                                //-span Step 12: Blends percentage = [ #{lower.affection.Blends} : #{lower.affection.R} (#{(lower.affection.Blends * 100 / lower.affection.R).toFixed(0)}%) ]
                                                                span Step 12: Blends percentage = [ #{lower.affection.Blends} : #{lower.affection.R} (#{roundTo(lower.affection.Blends * 100 / lower.affection.R, 0)}%) ]
                                                                br
                                                                span(style='margin-left: 10px;') & EBStyle(
                                                                    if experienceClassification.copyingStyle=="Introversive" && experienceClassification.approachStyle=="True"
                                                                        i.fa.fa-check-square-o
                                                                    else
                                                                        i.fa.fa-square-o
                                                                    |  Introversive 
                                                                    if experienceClassification.copyingStyle=="Extratensive" && experienceClassification.approachStyle=="True"
                                                                        i.fa.fa-check-square-o
                                                                    else
                                                                        i.fa.fa-square-o
                                                                    |  Extratensive 
                                                                    if experienceClassification.copyingStyle=="Ambitent" && experienceClassification.approachStyle=="True"
                                                                        i.fa.fa-check-square-o
                                                                    else
                                                                        i.fa.fa-square-o
                                                                    |  Ambitent
                                                                    if lower.core.Lambda > 0.99
                                                                        i.fa.fa-check-square-o
                                                                    else
                                                                        i.fa.fa-square-o
                                                                    |  Avoidant)
                                                                br
                                                                span Step 13: Blends related to situational stress
                                                                br
                                                                span(style='margin-left: 28px;') m blends = [ #{mBlends} ] & Y blends = [ #{YBlends} ], Re-Blends% = [ #{reBlendsPercent}% ]
                                                                br
                                                                span Step 14: Blend complexity (unusual complexity)
                                                                br
                                                                span(style='margin-left: 48px;') 3 determinants = [ #{_3Blends} ], 4 determinants = [ #{_4Blends} ]
                                                                br
                                                                span Step 15: Color-shading blends
                                                                br
                                                                span(style='margin-left: 48px;') Color + C', V, T = [ #{OtherColorShading} ], Color + Y = [ #{YColorShading} ]
                                                                br
                                                                span Step 16: Shading blends = [ #{shadingBlends} ]
                                            tr   
                                                td
                                                    ul
                                                        li 정서 중요 변인: 정서비율(Affective Ratio: Afr), 형태-유채색 비율(FC : CF + C), 순수 유채색(PureC)
                                                        li
                                                            | 정서 관련 개념: 정서 기능(Affective Functioning), 문제해결과 대처 전략(Coping Strategy with Problem Solving),
                                                            br
                                                            .indent 정서적 감수성(Emotional Receptivity), 심리적 복잡성과 불안정성(Psychological Complexity & lability)
                                                        li
                                                            | 내인성 우울(Endogenous Depression), 반응성 우울(Reactive Depression), 양극성 특성(Bipolar Characteristics)
                                                                    
                            - var flag = true;
                            each step in stepLeft
                                .row
                                    .col-md-12
                                        if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                            if flag
                                                | &#x27B2;
                                                - flag = false
                                        p(style="font-size: 11pt; line-height: 160%;")
                                            if step.textData.length == 0
                                            else
                                                span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                each text in step.textData
                                                    if !text.includes('[질적 분석]')
                                                        !=text
                            .row
                                .col-md-12(style='font-size: 11pt; line-height: 160%;')
                                    ul
                                        li
                                            |질적 분석할 단계
                                            br
                                            | Step 10: Pure C = [ #{lower.affection.PureC} ]
                                //-
                                    table.table.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 질적 해석
                                        tbody
                                            tr
                                                td
                                                    p
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                if T.resultName == 'Ideation 관념화'
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    img(src='/img/ideation.jpg', style='max-width: 100%;height: 60px')
                                    //-h3 관념화 영역 (Ideation)
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 관념화 영역(Ideation) 분석 단계 
                                        tbody
                                            tr
                                                td
                                                    p R = [ #{lower.affection.R} ] Lambda = [ #{lower.core.Lambda} ] (
                                                        if lower.core.Lambda > 0.99
                                                            i.fa.fa-check-square-o
                                                            |  High 
                                                            i.fa.fa-square-o
                                                            |  Low
                                                        else if lower.core.Lambda <=0.99 && lower.core.Lambda>=0.3
                                                            i.fa.fa-square-o
                                                            |  High 
                                                            i.fa.fa-square-o
                                                            |  Low
                                                        else
                                                            i.fa.fa-square-o
                                                            |  High 
                                                            i.fa.fa-check-square-o
                                                            |  Low
                                                        |) 
                                                        if lower.special_indices.PTI>=4
                                                            i.fa.fa-check-square-o
                                                        else
                                                            i.fa.fa-square-o
                                                        |  PTI = [ #{lower.special_indices.PTI} ]  &nbsp;
                                                        if lower.special_indices.DEPIPositive == true
                                                            i.fa.fa-check-square-o
                                                        else
                                                            i.fa.fa-sqaure-o
                                                        |  DEPI = [ #{lower.special_indices.DEPI} ]
                                                    .row
                                                        .col-md-6
                                                            p
                                                                //-span Step 1: EB = [ #{(lower.core.EBLeft).toFixed(0)} : #{(lower.core.EBRight).toFixed(1)} ] & Lambda(L) = [ #{lower.core.Lambda} ] #{lower.core.LambdaHighOrLow}
                                                                span Step 1: EB = [ #{roundTo(lower.core.EBLeft, 0)} : #{roundTo(lower.core.EBRight, 1)} ] & Lambda(L) = [ #{lower.core.Lambda} ] #{lower.core.LambdaHighOrLow}
                                                                br
                                                                if lower.core.EBPer == 'N/A'
                                                                    span Step 2: EBPer = [ N/A ]
                                                                else
                                                                    //-span Step 2: EBPer = [ #{parseFloat(lower.core.EBPer).toFixed(1)} ]
                                                                    span Step 2: EBPer = [ #{roundTo(parseFloat(lower.core.EBPer), 1)} ]
                                                                br
                                                                span Step 3: active : passive (a:p) = [ #{lower.interpersonal.a} : #{lower.interpersonal.p} ]
                                                                br
                                                                span Step 4: 
                                                                    if lower.special_indices.HVIPositive == true
                                                                        i.fa.fa-check-square-o
                                                                        |  HVI = [ Yes ],  
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  HVI = [ No ], 
                                                                    if lower.special_indices.OBSPositive == true
                                                                        i.fa.fa-check-square-o
                                                                        |  OBS = [ Yes ], 
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  OBS = [ No ], 
                                                                    | MOR = [ #{lower.self_perception.MOR} ]
                                                                br
                                                                span Step 5: Left side eb = [ #{lower.core.ebLeft} ]
                                                        .col-md-6
                                                            p
                                                                span Step 6: Ma : Mp = [ #{lower.ideation.Ma} : #{lower.ideation.Mp} ]
                                                                br
                                                                span Step 7: Intellectualization Index = [ #{lower.ideation.twoABplusArtplusAy} ]
                                                                br
                                                                span Step 8: Sum6 = [ #{lower.ideation.Sum6} ] & WSum6 = [ #{lower.ideation.WSum6} ]
                                                                br
                                                                span Step 9: Quality 6 Special Scores (질적 분석)
                                                                br
                                                                span Step 10: M- = [ #{lower.ideation.Mminus} ], M none = [ #{lower.ideation.Mnone} ]
                                                                br
                                                                span Step 11: Quality of M responses (질적 분석)
                                            tr
                                                td
                                                    ul

                                                        li
                                                            | 관념화 중요변인: 가중특수점수(WSum6), 형태질 없는 인간운동(M none)
                                                        li
                                                            | 관념화 관련개념: 사고기능(Ideational Functioning), 사고 문제(Thinking Problems), 의사결정(Decision-Making),
                                                            .indent
                                                                | 문제해결과 대처전략(Coping Strategy with Problem Solving), 자아 손상(Ego Impairment)
                            - var flag = true;
                            - var steps = T.steps.filter((step) => step.textData.length);
                            - var steps1 = steps;//.splice(0, 5)
                            each step in steps1
                                .row
                                    .col-md-12
                                        if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                            if flag
                                                | &#x27B2;
                                                - flag = false
                                        p(style="font-size: 11pt; line-height: 160%;")
                                            if step.textData.length == 0
                                            else
                                                span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                each text in step.textData
                                                    if !text.includes('[질적 분석] ')
                                                        !=text
                            .row
                                .col-md-12(style="font-size: 11pt; line-height: 160%;")
                                    ul
                                        li
                                            |  질적 분석할 단계
                                            br
                                            | Step 9: Quality 6 Special Scores (연령과 지적기능 고려)
                                            br
                                            | Step 11: Quality of M responses (연령 고려)
                //-
                    if steps.length > 0
                        .wide-page
                            .wide-subpage
                                .row
                                    .col-md-12
                                        each step in steps
                                            if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                                if flag
                                                    | &#x27B2;
                                                    - flag = false
                                            p(style="font-size: 11pt; line-height: 160%;")
                                                span(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                if step.textData.length == 0
                                                else
                                                    each text in step.textData
                                                        if !text.includes('[질적 분석] ')
                                                            !=text
                                .row
                                    .col-md-12(style="font-size: 11pt; line-height: 160%;")
                                        ul
                                            li
                                                |  질적 분석할 단계
                                                br
                                                | Step 9: Quality 6 Special Scores (연령과 지적기능 고려)
                                                br
                                                | Step 11: Quality of M responses (연령 고려)
                                //-
                                    table.table.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 질적 해석
                                        tbody
                                            tr
                                                td
                                                    p
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                if T.resultName == 'Cognitive Mediation / Cognitive triad 인지적 중재'
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    img(src='/img/cognitive_mediation.jpg', style='max-width: 100%;height: 60px;')
                                    //-h3 인지적 중재 (Cognitive Mediation)
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 인지적 중재 영역(Cognitive Mediation) 분석 단계
                                        tbody
                                            tr
                                                td
                                                    p R = [ #{lower.affection.R} ] &nbsp;&nbsp; Lambda(L) = [ #{lower.core.Lambda} ] (
                                                        if lower.core.Lambda > 0.99
                                                            i.fa.fa-check-square-o
                                                            |  High 
                                                            i.fa.fa-square-o
                                                            |  Low
                                                        else if lower.core.Lambda <=0.99 && lower.core.Lambda>=0.3
                                                            i.fa.fa-square-o
                                                            |  High 
                                                            i.fa.fa-square-o
                                                            |  Low
                                                        else
                                                            i.fa.fa-square-o
                                                            |  High 
                                                            i.fa.fa-check-square-o
                                                            |  Low
                                                        |)&nbsp;&nbsp; Populars(P) = [ #{lower.cognitive_mediation.P} ] &nbsp;&nbsp;
                                                        if lower.special_indices.OBSPositive == true
                                                            i.fa.fa-check-square-o
                                                            |  OBS = [ Yes ]
                                                        else
                                                            i.fa.fa-square-o
                                                            |  OBS = [ No ]
                                                    .row
                                                        .col-md-6
                                                            p
                                                                span Step 1: XA% = [ #{lower.cognitive_mediation.XAper} ] & WDA% = [ #{lower.cognitive_mediation.WDAper} ]
                                                                br
                                                                span Step 2: FQ none(FQx none) = [ #{upper.form_quality.FQx['none']} ]
                                                                br
                                                                //-span Step 3: X-% = [ #{lower.cognitive_mediation.Xminusper.toFixed(2)} ], FQx- frequence = [ #{upper.form_quality.FQx['-']} ],
                                                                span Step 3: X-% = [ #{roundTo(lower.cognitive_mediation.Xminusper, 2)} ], FQx- frequence = [ #{upper.form_quality.FQx['-']} ],
                                                                br
                                                                - var DdSMinus = 0;
                                                                each score in scores
                                                                    if score.loc == 'DdS' && score.fq == '-'
                                                                        - DdSMinus += 1
                                                                span(style='margin-left: 42px;') FQxS- frequency = [ #{lower.cognitive_mediation.Sminus} ], FQxDd- frequence = [ #{upper.form_quality.FQx['-'] - upper.form_quality.WPlusD['-'] - DdSMinus } ]
                                                        .col-md-6
                                                            p
                                                                span Step 3a: Homogeneity issues
                                                                br
                                                                span Step 3b: Minus distortion levels (질적 분석)
                                                                br
                                                                span Step 4: Populars(P) = [ #{lower.cognitive_mediation.P} ]
                                                                br
                                                                span Step 5: FQ+ frequency = [ #{upper.form_quality.FQx['+']} ]
                                                                br
                                                                span Step 6: X+% = [ #{lower.cognitive_mediation.Xplusper} ] & Xu% = [ #{lower.cognitive_mediation.Xuper} ]
                                            tr
                                                td
                                                    ul
                                                        li
                                                            | 인지적 중재 중요변인: 적절한 형태질(XA%), 일반적 위치의 적절한 형태질(WDA%), 왜곡된 형태질(X-%)
                                                        li
                                                            | 인지적 중재 관련개념: 사고기능(Ideational Functioning), 현실 검증 능력(Reality Testing), 판단력(Judgment), 
                                                            .indent
                                                                | 관습적 행동(Conventional Behavior)
                            - var flag = true;
                            - var steps = T.steps.filter((step) => { return step.textData.length });
                            - steps1 = steps;//.splice(0, 5);
                            each step in steps1
                                .row
                                    .col-md-12
                                        if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                            if flag
                                                | &#x27B2;
                                                - flag = false
                                        p(style="font-size: 11pt; line-height: 160%;")
                                            if step.textData.length == 0
                                            else
                                                span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                each text in step.textData
                                                    if !text.includes('[질적 분석]')
                                                        !=text
                            .row
                                .col-md-12(style="font-size: 11pt; line-height: 160%;")
                                    ul
                                        li
                                            | 질적 분석할 단계
                                            br
                                            | Step 3b: Minus distortion levels (형태 왜곡 수준 분석)
                //-
                    if steps.length > 0 
                        .wide-page
                            .wide-subpage
                                .row
                                    .col-md-12
                                        each step in steps
                                            if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                                if flag
                                                    | &#x27B2;
                                                    - flag = false
                                            p(style="font-size: 11pt; line-height: 160%;")
                                                span(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                if step.textData.length == 0
                                                else
                                                    each text in step.textData
                                                        if !text.includes('[질적 분석]')
                                                            !=text
                                .row
                                    .col-md-12(style="font-size: 9pt;")
                                        ul
                                            li
                                                | 질적 분석할 단계
                                                br
                                                | Step 3b: Minus distortion levels (형태 왜곡 수준 분석)

                                //-
                                    table.table.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 질적 해석
                                        tbody
                                            tr
                                                td
                                                    p ✽ 심각한 왜곡이 있을 경우 Step 3과 Step3a에서 도출된 가정을 수정하세요.
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                if T.resultName == 'Information Processing / Cognitive triad 정보처리'
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    img(src='/img/information_processing.jpg', style='max-width: 100%;height: 60px;')
                                    //-h3 정보 처리 영역 (Information Processing)
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 정보 처리 영역(Information Processing) 분석 단계
                                        tbody
                                            tr
                                                td
                                                    p R = [ #{lower.affection.R} ] Lambda = [ #{lower.core.Lambda} ] (
                                                        if lower.core.Lambda > 0.99
                                                            i.fa.fa-check-square-o
                                                            |  High 
                                                            i.fa.fa-square-o
                                                            |  Low
                                                        else if lower.core.Lambda <=0.99 && lower.core.Lambda>=0.3
                                                            i.fa.fa-square-o
                                                            |  High 
                                                            i.fa.fa-square-o
                                                            |  Low
                                                        else
                                                            i.fa.fa-square-o
                                                            |  High 
                                                            i.fa.fa-check-square-o
                                                            |  Low
                                                        |) 
                                                        if lower.special_indices.OBSPositive == true
                                                            i.fa.fa-check-square-o
                                                            |  OBS = [ Yes ] 
                                                        else
                                                            i.fa.fa-square-o
                                                            |  OBS = [ No ] 
                                                        if lower.special_indices.HVIPositive == true
                                                            i.fa.fa-check-square-o
                                                            |  HVI = [ Yes ] 
                                                        else
                                                            i.fa.fa-square-o
                                                            |  HVI = [ No ] 
                                                        | EB = [ #{lower.core.EBLeft} : #{roundTo(lower.core.EBRight, 1)} ]
                                                    .row
                                                        .col-md-6
                                                            p
                                                                span Step 1: Zf = [ #{lower.information_processing.Zf} ]
                                                                br
                                                                span Step 2: W : D : Dd = [ #{lower.information_processing.W} : #{lower.information_processing.D} : #{lower.information_processing.Dd} ]
                                                                br
                                                                span Step 3: Location Sequencing (질적 분석)
                                                                br
                                                                span Step 4: W : M [ #{lower.information_processing.W} : #{lower.information_processing.M} ]
                                                        .col-md-6
                                                            p
                                                                span 
                                                                    | Step 5: Zd = [ 
                                                                    +parseSign(lower.information_processing.Zd)
                                                                    | &nbsp;]
                                                                br
                                                                span Step 6: PSV = [ #{lower.information_processing.PSV} ]
                                                                br
                                                                span Step 7: DQ+ = [ #{lower.information_processing.DQplus} ], DQv = [ #{lower.information_processing.DQv} ]
                                                                br
                                                                span Step 8: DQ sequencing (질적 분석)
                                            tr
                                                td
                                                    ul
                                                        li
                                                            | 정보처리 중요변인: 기대지표(Aspirational Ratio: W:M), 처리 효율성(Processing Efficiency: Zd)
                                                        li
                                                            | 정보처리 관련개념: 사고기능(Ideational Functioning), 지각의 점검(Perceptual Monitoring), 동기(Motivation),
                                                            .indent
                                                                | 정보의 탐색(search of information)과 정보의 조직화(structuralization of information)

                            - var flag = true;
                            each step in T.steps
                                .row
                                    .col-md-12
                                        if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                            if flag
                                                | &#x27B2;
                                                - flag = false
                                        p(style="font-size: 11pt; line-height: 160%;")
                                            if step.textData.length == 0
                                            else
                                                span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                each text in step.textData
                                                    if !text.includes('[질적 분석]')
                                                        !=text
                            .row
                                .col-md-12(style="font-size: 11pt; line-height: 160%;")
                                    ul
                                        li
                                            | 질적 분석할 단계
                                            br
                                            | Step 3: Location Sequencing 
                                            br
                                            | Step 8: DQ sequencing 
                                //-
                                    table.table.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 질적 해석
                                        tbody
                                            tr
                                                td
                                                    p
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                if T.resultName == 'Self-perception 자기개념(자기상), 자기중심성(자기관여), 자기가치(자존감), 자기효능감 평가'
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    img(src='/img/self_perception.jpg', style='max-width: 100%;height: 60px;')
                                    //-h3 자기 지각 영역 (Self-Perception)
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style="font-size: 9pt;")
                                        thead
                                            tr
                                                th.text-center 자기 지각 영역(Self-Perception) 분석 단계
                                        tbody
                                            tr
                                                td
                                                    .row
                                                        .col-md-6(style='padding-right: 0;')
                                                            p
                                                                span Step 1: 
                                                                    if lower.special_indices.OBSPositive == true
                                                                        i.fa.fa-check-square-o
                                                                        |  OBS = [ YES ] & 
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  OBS = [ No ] & 
                                                                    if lower.special_indices.HVIPositive == true
                                                                        i.fa.fa-check-square-o
                                                                        |  HVI = [ Yes ]
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  HVI = [ No ]
                                                                br
                                                                span Step 2: Reflections(Fr+rF) = [ #{lower.self_perception.Reflections} ]
                                                                br
                                                                span Step 3: Egocentricity Index = [ #{lower.self_perception.EgocentricityIndex} ]
                                                                br
                                                                span Step 4: FD = [ #{lower.self_perception.FD} ] & Sum V(Vista) = [ #{lower.self_perception.SumV} ]
                                                                br
                                                                span(style='margin-left: 42px;') (in relation to History) (질적 분석)
                                                                br
                                                                span Step 5: An + Xy = [ #{lower.self_perception.AnPlusXy} ]
                                                                br
                                                                span Step 6: MOR = [ #{lower.self_perception.MOR} ]
                                                                br
                                                                span Step 7: H : (H) + Hd + (Hd) = [ #{lower.self_perception.H} : #{lower.self_perception.Hrest} ]
                                                                br
                                                                span(style="display: inline-block; margin-left: 28px;") Review codings for Human Content responses (질적 분석)
                                                        .col-md-6
                                                            p
                                                                span Step 8: Search for projections in: (질적 분석)
                                                                br
                                                                span(style='margin-left: 28px;') a: Minus responses(FQx-) = [ #{upper.form_quality.FQx['-']} ]
                                                                br
                                                                span(style='margin-left: 28px;') b: MOR responses = [ #{upper.special_scores.MOR} ]
                                                                br
                                                                span(style='margin-left: 28px;') c: M responses = [ #{lower.information_processing.M} ]
                                                                br
                                                                span(style='margin-left: 42px;') & Human Content responses = [ #{lower.interpersonal.HumanCont} ]
                                                                br
                                                                span(style='margin-left: 28px;') d: FM responses = [ #{upper.determinants.FM} ] & m responses = [ #{upper.determinants.m} ]
                                                                br
                                                                span(style='margin-left: 28px;') e: Embellishments in other responses
                                                                br
                                                                span *윤색(각색: Embellishment): 꾸미는 말이 포함되어 있어 일반적   반응보다 더 내용이 풍부한 반응. 왜곡된 반응도 해당함.
                                            tr
                                                td
                                                    ul
                                                        li
                                                            | 자기지각 영역의 중요변인: 자기중심지표(Egocentricity Index), 해부-엑스레이(An+Xy), 병적인 내용(MOR)
                                                        li
                                                            | 자기지각 영역의 관련개념: 자기개념(Self–Concept), 자존감(Self-Esteem), 자기성찰(Introspection)


                            - var flag = true;
                            - var steps = T.steps.filter((t) => t.textData.length)
                            - var steps1 = steps;//.splice(0, 5)
                            each step in steps1
                                .row
                                    .col-md-12
                                        if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                            if flag
                                                | &#x27B2;
                                                - flag = false
                                        p(style="font-size: 11pt; line-height: 160%;")
                                            if step.textData.length == 0
                                            else
                                                span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                each text in step.textData
                                                    if !text.includes('[질적 분석]')
                                                        !=text
                            .row
                                .col-md-12(style="font-size: 11pt; line-height: 160%;")
                                    ul
                                        li
                                            | 질적 분석할 단계
                                            br
                                            | Step 4: FD  = [ #{upper.determinants.FD} ] & Sum V(Vista) = [ #{lower.self_perception.SumV} ] (in relation to History)
                                            br
                                            | Step 7: Review codings for Human Content reponses   
                                            br
                                            | Step 8: Searching for projected material 
                //-
                    if steps.length > 0
                        .wide-page
                            .wide-subpage
                                .row
                                    .col-md-12
                                        each step in steps
                                            if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                                if flag
                                                    | &#x27B2;
                                                    - flag = false
                                            p(style="font-size: 11pt; line-height: 160%;")
                                                span(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                if step.textData.length == 0
                                                else
                                                    each text in step.textData
                                                        if !text.includes('[질적 분석]')
                                                            !=text
                                .row
                                    .col-md-12(style="font-size: 11pt; line-height: 160%;")
                                        ul
                                            li
                                                | 질적 분석할 단계
                                                br
                                                | Step 4: FD  = [ #{upper.determinants.FD} ] & Sum V(Vista) = [ #{lower.self_perception.SumV} ] (in relation to History)
                                                br
                                                | Step 7: Review codings for Human Content reponses   
                                                br
                                                | Step 8: Searching for projected material 

                                //-
                                    table.table.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 질적 해석
                                        tbody
                                            tr
                                                td
                                                    p
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                                                        br
                if T.resultName == 'Control and Stress Tolerance 통제 능력과 스트레스 저항력 평가'
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    img(src='/img/control_and_stress_tolerance.jpg', style='max-width: 100%;height: 60px;')
                                    //-h3 통제력과 스트레스 저항력 (Control and Stress Tolerance)
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style="font-size: 9pt;")
                                        thead
                                            tr
                                                th.text-center 통제력과 스트레스 저항력 영역(Control and Stress Tolerance) 분석 단계
                                        tbody
                                            tr
                                                td
                                                    .row
                                                        .col-md-6
                                                            p
                                                                span Step 1: Adjusted D(Adj D) Score = [#{lower.core.AdjD}] & 
                                                                    if lower.special_indices.CDIPositive == true
                                                                        i.fa.fa-check-square-o
                                                                    else
                                                                        i.fa.fa-square-o
                                                                    |  CDI = [ #{lower.special_indices.CDI} ]
                                                                br
                                                                //-span Step 2: EA = [ #{lower.core.EA.toFixed(1)} ]
                                                                span Step 2: EA = [ #{roundTo(lower.core.EA, 1)} ]
                                                                br
                                                                span 
                                                                    //-|Step 3: EB = [ #{lower.core.EBLeft.toFixed(1)} : #{lower.core.EBRight.toFixed(1)} ] 
                                                                    |Step 3: EB = [ #{roundTo(lower.core.EBLeft, 0)} : #{roundTo(lower.core.EBRight, 1)} ] 
                                                                    br
                                                                span(style='margin-left: 40px;')
                                                                    |& Lambda(L) = [ #{lower.core.Lambda} ]
                                                                    | (
                                                                    if parseFloat(lower.core.Lambda) > 0.99
                                                                        i.fa.fa-check-square-o
                                                                        |  High  
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  High  
                                                                    if parseFloat(lower.core.Lambda) < 0.3
                                                                        i.fa.fa-check-square-o
                                                                        |  Low
                                                                    else
                                                                        i.fa.fa-square-o
                                                                        |  Low
                                                                    
                                                                    |  )
                                                        .col-md-6
                                                            p
                                                                span Step 4: es = [ #{lower.core.es} ] & Adjusted es(Adj es) = [ #{lower.core.Adjes} ]
                                                                br
                                                                span Step 5: eb = [ #{lower.core.ebLeft} : #{lower.core.ebRight} ]
                                            tr
                                                td
                                                    ul
                                                        li
                                                            | 통제력 중요변인: 조정된 자원-스트레스 차이 점수(Adjusted Difference Score: Adj D), 대처결함지표(CDI)
                                                        li
                                                            | 통제력 관련개념: 전반적 적응 상태(General Adjustment Condition), 심리적 자원(Psychological Resources), 
                                                            .indent 자아 강도(Ego Strength), 자기 조절(Self-Regulation), 스트레스 수준(Quantity of Stress),
                                                            .indent 정서의 통제(Emotional Control),  정서의 억제(Emotional Constraint)
                                                            .indent <span class='text-danger'>2차 사고과정(secondary process thinking) vs 1차 사고과정(primary process thinking)</span>
                            - var flag = true;
                            each step in T.steps
                                .row
                                    .col-md-12
                                if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                    if flag
                                        | &#x27B2;
                                        - flag = false
                                p(style="font-size: 11pt; line-height: 160%;")
                                    if step.textData.length == 0
                                    else
                                        span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                        each text in step.textData
                                            if !text.includes('[질적 분석]')
                                                !=text
                if T.resultName == '평소 통제능력보다 낮은 현재 통제능력을 유발하는 상황 관련 스트레스 평가'
                    .wide-page
                        .wide-subpage
                            .row
                                .col-md-12
                                    img(src='/img/situation_related_stress.jpg', style='max-width: 100%;height: 60px;')
                                    //-h3 상황 관련 스트레스 영역 (Situation-Related Stress)
                            .row
                                .col-md-12
                                    table.table.table-striped.table-bordered(style='font-size: 9pt;')
                                        thead
                                            tr
                                                th.text-center 상황 관련 스트레스 영역(Situation-Related Stress) 분석 단계
                                        tbody
                                            tr
                                                td
                                                    .row
                                                        .col-md-6
                                                            p
                                                                span Step 1: D Score in relation to as and Adj es
                                                                br
                                                                span(style='margin-left: 42px;') D = [ #{lower.core.D} ], Adj D = [ #{lower.core.AdjD} ], es - Adj es = [ #{lower.core.es - lower.core.Adjes} ]
                                                                br
                                                                span Step 2: Difference between D Score 
                                                                br
                                                                //-span(style='margin-left: 42px;') & Adj D Score AdjD - D = [ #{(lower.core.D - lower.core.AdjD).toFixed(0)} ]
                                                                span(style='margin-left: 42px;') & Adj D Score AdjD - D = [ #{roundTo(lower.core.AdjD - lower.core.D, 0)} ]
                                                                br
                                                                span Step 3: m = [ #{upper.determinants.m} ] & Sum Y = [ #{lower.core.SumY} ]
                                                        .col-md-6
                                                            p
                                                                span Step 4: Sum T = [ #{lower.interpersonal.SumT} ], Sum V = [ #{lower.self_perception.SumV} ],
                                                                br
                                                                span(style='margin-left: 42px;') Egocentricity Index = [ #{lower.self_perception.EgocentricityIndex} ] in relation to History
                                                                br
                                                                span Step 5: D Score = [ #{lower.core.D} ] (re Pure C, M-, no Form)
                                                                br
                                                                span Step 6: Blends created by m or Y = [ #{blendsCreatedBymOrY} ] ( #{Math.round(blendsCreatedBymOrY * 100 / upper.blends.length)}% )
                                                                br
                                                                span Step 7: Color-Shading Blends
                                                                br
                                                                span(style='margin-left: 42px;') Y-Color-Shading Blends = [ #{YColorShading} ],
                                                                br
                                                                span(style='margin-left: 42px;') Other Color-Shading Blends = [ #{OtherColorShading} ]
                                            tr
                                                td
                                                    ul
                                                        li
                                                            | 상황 관련 스트레스 개념: 생활사건(Life Event: Personal History), 자극 과부하(Stimulus Overload), 
                                                            .indent
                                                                | 정서적 혼란(Emotional Confusion)
                            .row
                                .col-md-12
                                    h5 ❊ 심리적 문제와 관련된 것으로 추정되는 최근 사건을 함께 고려하세요.
                            - var flag = true;
                            each step in T.steps
                                .row
                                    .col-md-12
                                        if step.textData.length != 0 && !JSON.stringify(step.textData).includes('[질적 분석]')
                                            if flag
                                                | &#x27B2;
                                                - flag = false
                                        p(style="font-size: 11pt; line-height: 160%;")
                                            if step.textData.length == 0
                                            else
                                                span.text-blue(style="color: blue; font-size: 11pt; line-height: 160%;") [Step #{step.curStep}]
                                                each text in step.textData
                                                    if !text.includes('[질적 분석]')
                                                        !=text

                    
        script(src="/js/jquery-2.1.1.js")
        script(src="/js/bootstrap.min.js")
        script(src="/js/plugins/metisMenu/jquery.metisMenu.js")
        script(src="/js/plugins/slimscroll/jquery.slimscroll.min.js")
        script(src="/js/inspinia.js")
        script(src="/js/plugins/pace/pace.min.js")
        script(src="/js/plugins/flot/jquery.flot.js")
        script(src="/js/plugins/flot/jquery.flot.tooltip.min.js")
        script(src="/js/plugins/flot/jquery.flot.resize.js")
        script(src="/js/plugins/chartJs/Chart.min.js")
        script(src="/js/plugins/peity/jquery.peity.min.js")
        script(src="/js/demo/peity-demo.js")
        script(src="/js/plugins/fullcalendar/moment.min.js")
        script(src="/js/plugins/datapicker/bootstrap-datepicker.js")
        script(src="/js/plugins/daterangepicker/daterangepicker.js")
        script(src="/js/plugins/clockpicker/clockpicker.js")
        script(src="http://html2canvas.hertzen.com/dist/html2canvas.min.js")
        script.
            var max_pages = 100;
            var page_count = 0;
            function snipMe() {
                page_count++;
                if (page_count > max_pages) {
                    return;
                }
                var long = $(this)[0].scrollHeight - Math.ceil($(this).innerHeight());
                //console.log($(this)[0].scrollHeight, Math.ceil($(this).innerHeight()))
                var children = $(this).children().toArray(); // Save elements in this page to children[] array
                var removed = [];
                // Loop while this page is longer than an A4 page
                while (long > 0 && children.length > 0) {
                    var child = children.pop(); // Remove last array element from the children[] array 
                    $(child).detach();  // JQuery Method detach() removes the "child" element from DOM for the current page
                    removed.push(child);  // Add element that was removed to the end of "removed" array
                    long = $(this)[0].scrollHeight - Math.ceil($(this).innerHeight()); // Compute current size of the page 
                }
                // If elements were removed from the page 
                if (removed.length > 0) {
                    var rev_removed = removed.reverse();  // Reverse the order of the removed array
                    var a4 = $('<div class="wide-subpage"></div>'); // Start a new page
                    var a4cover = $('<div class="wide-page"></div>');
                    a4.append(rev_removed); // Add elements removed from last page to the new page
                    a4cover.append(a4);
                    console.log(this);
                    a4cover.insertAfter($(this).parent()); // Add the ne wpage to the document
                    snipMe.call(a4[0]); // Recursively call myself to adjust the remainder of the pages
                }
            }
            $(document).ready(function(){
                $('.wide-subpage').each(function() {
                    snipMe.call(this);
                });
                //window.print();
            })
